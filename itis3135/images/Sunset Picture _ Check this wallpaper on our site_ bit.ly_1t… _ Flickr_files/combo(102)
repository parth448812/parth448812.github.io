YUI.add("search-content-filter-view",(function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.params=t,this.viewerPrefs,this.apiContentTypes,this.apiVideoTypes,this.defaultContentTypes,this.defaultVideoTypes,this.fluidDropDownModal,this.dropDownOptions=[{id:0,name:this.intlMessage({intlName:"search.PHOTOS"}),alias:"photos",isSelected:!1,value:"0"},{id:1,name:this.intlMessage({intlName:"search.SCREENSHOTS"}),alias:"screenshots",isSelected:!1,value:"1"},{id:2,name:this.intlMessage({intlName:"common.ILLUSTRATION_ART"}),alias:"illustrationArt",isSelected:!1,value:"2"},{id:3,name:this.intlMessage({intlName:"search.VIRTUAL_PHOTOGRAPHY"}),alias:"virtualPhotography",isSelected:!1,value:"3"},{id:4,name:this.intlMessage({intlName:"search.VIDEOS"}),alias:"videos",isSelected:!1,value:"0,1,2,3"}],this.searchUrl=t.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),this.currentContentTypeString="",this.dropDownHasFiredChange=!1,this},loadState:function(){var t=this;return this.appContext.getViewer().signedIn&&this.params.modelParams&&this.params.modelParams.viewerNsid?this.appContext.callAPI("flickr.prefs.getPrefs",{user_id:this.params.modelParams.viewerNsid,extras:["content_type_search","no_video_search"].join(",")}).then(function(i){return t.viewerPrefs={content_types:i.settings_prefs.content_type_search,no_video_search:i.settings_prefs.no_video_search},t.populateStatefulData(),e.Promise.resolve()}.bind(t)):(this.populateStatefulData(),e.Promise.resolve())},populateStatefulData:function(){e.SearchHelper.formatContentTypeParams(this.appContext,this.viewerPrefs),this.apiContentTypes=this.searchUrl.getAPIParam(e.SearchHelper.API.contentTypes),this.apiVideoTypes=this.searchUrl.getAPIParam(e.SearchHelper.API.videoContentTypes),this.defaultContentTypes=e.SearchHelper.UNIFIED_DEFAULT_PARAMS.content_types,this.defaultVideoTypes=e.SearchHelper.UNIFIED_DEFAULT_PARAMS.video_content_types,this.apiContentTypes||this.apiVideoTypes||(this.apiContentTypes=this.defaultContentTypes,this.apiVideoTypes=this.defaultVideoTypes),!this.apiContentTypes&&this.apiVideoTypes?this.apiContentTypes="":this.apiContentTypes&&!this.apiVideoTypes&&(this.apiVideoTypes=""),this.currentContentTypeString=this.apiContentTypes,this.setInitialSelectionState(this.currentContentTypeString,this.apiVideoTypes)},buildContainer:function(){return this.setContainerWithTemplate("search-content-filter",{}),this},activate:function(){this.get("container");return this.fluidDropDownModal=new e.Views.FluidSelectionDropdown({appContext:this.appContext,viewConfig:{dropDownOptions:this.dropDownOptions,viewAnchor:this.get("container"),showSelectionTopBar:!0}}),this.setAllEventListeners(),this},setAllEventListeners:function(){var t=this;this.registerEventHandler(e.on("selection-dropdown:valueChange",(function(e){t.handleSelectionChanges(e)}))),this.registerEventHandler(e.on("selection-dropdown:close",(function(){t.repositionDropDown(!0),t.updateApiParams()}))),this.registerEventHandler(e.on("selection-dropdown:open",(function(){t.registerEventHandler(e.globalEvents.subscribe("window:resize",(function(){t.fluidDropDownModal.close()}))),t.registerEventHandler(e.globalEvents.subscribe("window:scroll",(function(){t.fluidDropDownModal.close()}))),t.registerEventHandler(t.appContext.flapp.before("activeViewChange",(function(e){t.destroy()}))),t.registerEventHandler(e.on("advanced-options-panel:scroll",(function(){t.fluidDropDownModal.close()}))),t.repositionDropDown()})))},detachEventHandlers:function(){var e=this;this.viewFiredListeners.forEach((e=>e.detach())),this.registeredEventHandles.forEach((function(t){e.detachRegisteredEvent(t),t=null})),this.viewFiredListeners=[],this.registeredEventHandles=[]},repositionDropDown:function(t){var i,n,s,o=this.get("container"),r=e.one(".fluid-selection-dropdown-view"),a=e.one(".fluid-selection-options-container");t&&r?(o.append(r),r.setStyles({position:"static",width:"200px"})):o&&r&&(n=(i=o.getDOMNode().getBoundingClientRect()).bottom,s=i.left,r.setStyles({left:`${s}px`,top:`${n}px`,position:"fixed",width:"200px"}),a.setStyles({position:"static"}))},updateApiParams:function(){var t=this.getContentTypeString(),i=this.dropDownOptions.find((e=>"videos"===e.alias)),n=!1;t.length?this.searchUrl.params.content_types!==t&&(this.searchUrl.setAPIParam(e.SearchHelper.API.contentTypes,t),n=!0):e.SearchHelper.API.contentTypes.length&&(this.searchUrl.removeAPIParam(e.SearchHelper.API.contentTypes),n=!0),i.isSelected&&!this.searchUrl.params.video_content_types&&(this.searchUrl.setAPIParam(e.SearchHelper.API.videoContentTypes,i.value),n=!0),!i.isSelected&&this.searchUrl.params.video_content_types&&(this.searchUrl.removeAPIParam(e.SearchHelper.API.videoContentTypes),n=!0),n&&this.dropDownHasFiredChange&&this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},setInitialSelectionState:function(e,t){var i=this,n=this.dropDownOptions.find((e=>"videos"===e.alias));t&&t.length&&(n.isSelected=!0),e&&e.length&&e.split(",").forEach((function(e){i.dropDownOptions[e].isSelected=!0}))},handleSelectionChanges:function(e){this.dropDownOptions[e.id].isSelected=e.isSelected,this.dropDownHasFiredChange=!0,this.updateContentTypeString()},getContentTypeString:function(){return this.currentContentTypeString},updateContentTypeString:function(){var e=[];this.dropDownOptions.forEach((function(t){if(t.isSelected&&"videos"!==t.alias)return e.push(t.value)})),this.currentContentTypeString=e.join(",")}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-content-filter","search-helper","search-url","fluid-selection-dropdown-view"],langBundles:["search","common"]});YUI.add("search-slender-advanced-panel-view",(function(e){var t="search-advanced-panel-state";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i=t.modelParams&&t.modelParams.apiParams?e.merge(t.modelParams.apiParams):{};return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.searchUrl=new e.SearchUrl(i,this.appContext,t.searchType),t.searchUrl=this.searchUrl,this.unifiedSubviewParams=t.unifiedSubviewParams,this.set("areAdvancedOptionsVisible",this.getStoredAdvancedOptionsState()||t.openAdvanced),this.set("showToolbarOnly",t.showToolbarOnly||t.isMobile),this.set("showFilterMenus",t.showTools&&!t.isMobile),this.set("showInactiveGroupToggle",t.showInactiveToggle&&!t.isMobile),this.set("showSortMenu",t.showSort&&!t.isMobile),this.set("showLayoutToggles",t.showTools&&!t.isMobile),this.set("showInactiveGroupsToggle",t.showInactiveToggle&&!t.isMobile),this.set("isInactiveGroupsToggleChecked","0"!==this.searchUrl.getAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive)),this.set("layoutStyle",t.viewType||e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified),this},subviewConfig:{"search-color-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-style-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-orientation-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-min-size-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-date-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-search-in-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-content-filter-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var t=this,i=[];return this.appContext.getViewer().signedIn&&i.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then((function(e){t.set("viewerPrefsModel",e)}))),e.Promise.all(i)},buildContainer:function(){return this.setContainerWithTemplate("search-slender-advanced-panel",{collapseAdvancedOptions:!this.get("areAdvancedOptionsVisible"),showToolbarOnly:this.get("showToolbarOnly")}),this},activate:function(){var t=this.get("container"),i=this;return this.registerEventHandler(e.on("selection-dropdown:open",(function(){t.one(".advanced-options")&&i.registerEventHandler(t.one(".advanced-options").on("scroll",(function(){e.fire("advanced-options-panel:scroll")})))}))),this.get("showToolbarOnly")||this.registerEventHandler(t.one(".advanced-toggle").on("click",this.handleAdvancedToggleClick.bind(this))),this.registerEventHandler(t.delegate("mouseenter",this.handleTooltipElemMouseEnter.bind(this),"[data-tooltip-title]")),this.registerEventHandler(t.delegate("mouseleave",this.handleTooltipElemMouseLeave.bind(this),"[data-tooltip-title]")),t.setAttribute("role","toolbar"),this.setupAccessibilityAttributes(),this},setupAccessibilityAttributes:function(){var e=this.get("container"),t=e.all(".tabbable"),i=e.one(".advanced-toggle .tertiary");this.get("areAdvancedOptionsVisible")?(t.setAttribute("tabindex","0"),t.setAttribute("aria-hidden","false"),i&&i.setAttribute("aria-expanded","true")):(t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true"),i&&i.setAttribute("aria-expanded","false"))},onSubviewEvent:function(e,t){var i=t&&t.length&&t[0];switch(i){case"search:urlUpdate":t[1]&&(this.searchUrl=t[1],this.fire("subviewViewEvent","search:dirty"),this.appContext.flapp.navigate(this.searchUrl.getURL()));break;case"search:blackandwhiteStyleSelected":case"search:colorSelected":this.fire("parentViewEvent",i)}},handleLayoutToggleClick:function(e){var t,i,r=this.get("container");e.preventDefault(),(t=e.target.getData("layout-style"))!==this.get("layoutStyle")&&((i=r.one(".layout.selected"))&&i.removeClass("selected"),e.target.addClass("selected"),this.set("layoutStyle",t),this.get("viewerPrefsModel")&&(this.get("viewerPrefsModel").setValue("unifiedSearchViewPref",this.get("layoutStyle")),this.get("viewerPrefsModel").remoteUpdate()),this.fire("subviewViewEvent","search:layoutChange",this.get("layoutStyle")))},handleAdvancedToggleClick:function(t){var i=this.get("container"),r=i.one(".advanced-options"),s=this;t.preventDefault(),i.one(".advanced-icon").toggleClass("collapsed"),r.toggleClass("collapsed"),r.addClass("collapsing"),this.set("areAdvancedOptionsVisible",!this.get("areAdvancedOptionsVisible")),this.storeAdvancedOptionsState(this.get("areAdvancedOptionsVisible")),this.setupAccessibilityAttributes(),this.fire("subviewViewEvent","search:startAdvancedPanelTransition",this.get("areAdvancedOptionsVisible")),e.flutil.onTransitionEnd(r,(function(){r.removeClass("collapsing"),s.fire("subviewViewEvent","search:finishAdvancedPanelTransition",s.get("areAdvancedOptionsVisible"))}))},handleInactiveGroupsToggleChange:function(t){t.halt(),t.target.get("checked")?this.searchUrl.removeAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive):this.searchUrl.setAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive,"0"),this.appContext.flapp.navigate(this.searchUrl.getURL())},handleTooltipElemMouseEnter:function(t){var i=t.target.getData("tooltip-title"),r=this;t.halt(),this.tooltipDroparound&&this.tooltipDroparound.close(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!0,this.tooltipHoverTimer=setTimeout((function(){r.isHovering&&(r.tooltipDroparound=new e.Views.FluidDroparound({appContext:r.appContext,showDropArrow:!0,dismissOnOverlayClick:!1,dismissOnActionClick:!1,observePageResize:!0,anchorElement:t.target,positionFixed:!0,closeOnScroll:!0,invisibleOverlay:!0,autoSizeToContent:!0,useAnchorOffsetSize:!0,horizCenterToAnchor:!0,preferBottom:t.target.getData("tooltip-prefer-bottom"),classList:"advanced-panel-tooltip",textMessage:i}),r.tooltipDroparound.show())}),300)},handleTooltipElemMouseLeave:function(e){e.halt(),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()},getStoredAdvancedOptionsState:function(){var i;return YUI.Env.isServer||(e.SearchUrl.isSearchUrl(this.appContext.getPreviousURL())?i=e.AttributeHelpers.coerceBoolean(e.StorageHelper.getItem(t,!0)):e.StorageHelper.remove(t,!0)),i||!1},storeAdvancedOptionsState:function(i){YUI.Env.isServer||e.StorageHelper.setItem(t,i,!0)},beforeDestroy:function(){this.detachRegisteredEvents(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","search-color-picker-view","search-style-picker-view","search-orientation-picker-view","search-min-size-picker-view","search-search-in-picker-view","search-date-picker-view","hermes-template-search-slender-advanced-panel","attribute-helpers","storage-helper","flutil","person-preferences-models","search-content-filter-view"],optionalRequires:["pika-day"],langBundles:["search","pika-day","common","share-modal"]});YUI.add("pika-day",(function(t,e){"undefined"!=typeof window&&(this.moment=window.moment)
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */,(function(t,e){"use strict";var n;if("object"==typeof exports){try{n=require("moment")}catch(t){}module.exports=e(n)}else"function"==typeof define&&define.amd?define((function(t){try{n=t("moment")}catch(t){}return e(n)})):t.Pikaday=e(t.moment)})(this,(function(t){"use strict";var e="function"==typeof t,n=!!window.addEventListener,i=window.document,a=window.setTimeout,o=function(t,e,i,a){n?t.addEventListener(e,i,!!a):t.attachEvent("on"+e,i)},s=function(t,e,i,a){n?t.removeEventListener(e,i,!!a):t.detachEvent("on"+e,i)},r=function(t,e,n){var a;i.createEvent?((a=i.createEvent("HTMLEvents")).initEvent(e,!0,!1),a=p(a,n),t.dispatchEvent(a)):i.createEventObject&&(a=i.createEventObject(),a=p(a,n),t.fireEvent("on"+e,a))},l=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},h=function(t){return/Array/.test(Object.prototype.toString.call(t))},d=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},u=function(t){var e=t.getDay();return 0===e||6===e},f=function(t){return t%4==0&&t%100!=0||t%400==0},c=function(t){d(t)&&t.setHours(0,0,0,0)},m=function(t,e){return t.getTime()===e.getTime()},p=function(t,e,n){var i,a;for(i in e)(a=void 0!==t[i])&&"object"==typeof e[i]&&null!==e[i]&&void 0===e[i].nodeName?d(e[i])?n&&(t[i]=new Date(e[i].getTime())):h(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=p({},e[i],n):!n&&a||(t[i]=e[i]);return t},g=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},y={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},D=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},v=function(t,e,n,i,a,o,s){if(s)return'<td class="is-empty"></td>';var r=[];return o&&r.push("is-disabled"),a&&r.push("is-today"),i&&r.push("is-selected"),'<td data-day="'+t+'" class="'+r.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n+'" data-pika-month="'+e+'" data-pika-day="'+t+'">'+t+"</button></td>"},_=function(t,e){return"<tr>"+(e?t.reverse():t).join("")+"</tr>"},b=function(t,e,n,i,a){var o,s,r,l,d,u=t._o,f=n===u.minYear,c=n===u.maxYear,m='<div class="pika-title">',p=!0,g=!0;for(r=[],o=0;o<12;o++)r.push('<option value="'+(n===a?o-e:12+o-e)+'"'+(o===i?" selected":"")+(f&&o<u.minMonth||c&&o>u.maxMonth?"disabled":"")+">"+u.i18n.months[o]+"</option>");for(l='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month">'+r.join("")+"</select></div>",h(u.yearRange)?(o=u.yearRange[0],s=u.yearRange[1]+1):(o=n-u.yearRange,s=1+n+u.yearRange),r=[];o<s&&o<=u.maxYear;o++)o>=u.minYear&&r.push('<option value="'+o+'"'+(o===n?" selected":"")+">"+o+"</option>");return d='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year">'+r.join("")+"</select></div>",u.showMonthAfterYear?m+=d+l:m+=l+d,f&&(0===i||u.minMonth>=i)&&(p=!1),c&&(11===i||u.maxMonth<=i)&&(g=!1),0===e&&(m+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(m+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),m+"</div>"},w=function(t,e){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+(function(t){var e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+D(t,e)+'">'+D(t,e,!0)+"</abbr></th>");return"<thead>"+(t.isRTL?n.reverse():n).join("")+"</thead>"})(t)+("<tbody>"+e.join("")+"</tbody></table>")},M=function(s){var r=this,h=r.config(s);r._onMouseDown=function(t){if(r._v){var e=(t=t||window.event).target||t.srcElement;if(e){if(!l(e,"is-disabled")){if(l(e,"pika-button")&&!l(e,"is-empty"))return r.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),void(h.bound&&a((function(){r.hide(),h.field&&h.field.blur()}),100));l(e,"pika-prev")?r.prevMonth():l(e,"pika-next")&&r.nextMonth()}if(l(e,"pika-select"))r._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}}},r._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(l(e,"pika-select-month")?r.gotoMonth(e.value):l(e,"pika-select-year")&&r.gotoYear(e.value))},r._onInputChange=function(n){var i;n.firedBy!==r&&(i=e?(i=t(h.field.value,h.format))&&i.isValid()?i.toDate():null:new Date(Date.parse(h.field.value)),r.setDate(d(i)?i:null),r._v||r.show())},r._onInputFocus=function(){r.show()},r._onInputClick=function(){r.show()},r._onInputBlur=function(){var t=i.activeElement;do{if(l(t,"pika-single"))return}while(t=t.parentNode);r._c||(r._b=a((function(){r.hide()}),50)),r._c=!1},r._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,i=e;if(e){!n&&l(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),o(e,"change",r._onChange)));do{if(l(i,"pika-single")||i===h.trigger)return}while(i=i.parentNode);r._v&&e!==h.trigger&&i!==h.trigger&&r.hide()}},r.el=i.createElement("div"),r.el.className="pika-single"+(h.isRTL?" is-rtl":""),o(r.el,"mousedown",r._onMouseDown,!0),o(r.el,"change",r._onChange),h.field&&(h.container?h.container.appendChild(r.el):h.bound?i.body.appendChild(r.el):h.field.parentNode.insertBefore(r.el,h.field.nextSibling),o(h.field,"change",r._onInputChange),h.defaultDate||(e&&h.field.value?h.defaultDate=t(h.field.value,h.format).toDate():h.defaultDate=new Date(Date.parse(h.field.value)),h.setDefaultDate=!0));var u=h.defaultDate;d(u)?h.setDefaultDate?r.setDate(u,!0):r.gotoDate(u):r.gotoDate(new Date),h.bound?(this.hide(),r.el.className+=" is-bound",o(h.trigger,"click",r._onInputClick),o(h.trigger,"focus",r._onInputFocus),o(h.trigger,"blur",r._onInputBlur)):this.show()};return M.prototype={config:function(t){this._o||(this._o=p({},y,!0));var e=p(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,d(e.minDate)||(e.minDate=!1),d(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&(c(e.minDate),e.minYear=e.minDate.getFullYear(),e.minMonth=e.minDate.getMonth()),e.maxDate&&(c(e.maxDate),e.maxYear=e.maxDate.getFullYear(),e.maxMonth=e.maxDate.getMonth()),h(e.yearRange)){var i=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||y.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return d(this._d)?e?t(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,i){e&&t.isMoment(n)&&this.setDate(n.toDate(),i)},getDate:function(){return d(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",r(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),d(t)){var n=this._o.minDate,i=this._o.maxDate;d(n)&&t<n?t=n:d(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),c(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),r(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(d(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),a=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=a<n.getTime()||i.getTime()<a}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=g(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=g({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){this._o.minDate=t},setMaxDate:function(t){this._o.maxDate=t},draw:function(t){if(this._v||t){var e=this._o,n=e.minYear,i=e.maxYear,o=e.minMonth,s=e.maxMonth,r="";this._y<=n&&(this._y=n,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(var l=0;l<e.numberOfMonths;l++)r+='<div class="pika-lendar">'+b(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year)+this.render(this.calendars[l].year,this.calendars[l].month)+"</div>";if(this.el.innerHTML=r,e.bound&&"hidden"!==e.field.type&&a((function(){e.trigger.focus()}),1),"function"==typeof this._o.onDraw){var h=this;a((function(){h._o.onDraw.call(h)}),0)}}},adjustPosition:function(){if(!this._o.container){var t,e,n,a=this._o.trigger,o=a,s=this.el.offsetWidth,r=this.el.offsetHeight,l=window.innerWidth||i.documentElement.clientWidth,h=window.innerHeight||i.documentElement.clientHeight,d=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop;if("function"==typeof a.getBoundingClientRect)t=(n=a.getBoundingClientRect()).left+window.pageXOffset,e=n.bottom+window.pageYOffset;else for(t=o.offsetLeft,e=o.offsetTop+o.offsetHeight;o=o.offsetParent;)t+=o.offsetLeft,e+=o.offsetTop;(this._o.reposition&&t+s>l||this._o.position.indexOf("right")>-1&&t-s+a.offsetWidth>0)&&(t=t-s+a.offsetWidth),(this._o.reposition&&e+r>h+d||this._o.position.indexOf("top")>-1&&e-r-a.offsetHeight>0)&&(e=e-r-a.offsetHeight),this.el.style.cssText=["position: absolute","left: "+t+"px","top: "+e+"px"].join(";")}},render:function(t,e){var n=this._o,i=new Date,a=(function(t,e){return[31,f(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]})(t,e),o=new Date(t,e,1).getDay(),s=[],r=[];c(i),n.firstDay>0&&(o-=n.firstDay)<0&&(o+=7);for(var l,h,p,g,y=a+o,D=y;D>7;)D-=7;y+=7-D;for(var b=0,M=0;b<y;b++){var k=new Date(t,e,b-o+1),x=!!d(this._d)&&m(k,this._d),N=m(k,i),C=b<o||b>=a+o,T=n.minDate&&k<n.minDate||n.maxDate&&k>n.maxDate||n.disableWeekends&&u(k)||n.disableDayFn&&n.disableDayFn(k);r.push(v(b-o+1,e,t,x,N,T,C)),7==++M&&(n.showWeekNumber&&r.unshift((l=b-o,h=e,p=t,g=void 0,g=new Date(p,0,1),'<td class="pika-week">'+Math.ceil(((new Date(p,h,l)-g)/864e5+g.getDay()+1)/7)+"</td>")),s.push(_(r,n.isRTL)),r=[],M=0)}return w(n,s)},isVisible:function(){return this._v},show:function(){var t,e,n;this._v||(t=this.el,e="is-hidden",t.className=(n=(" "+t.className+" ").replace(" "+e+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,""),this._v=!0,this.draw(),this._o.bound&&(o(i,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t,e,n=this._v;!1!==n&&(this._o.bound&&s(i,"click",this._onClick),this.el.style.cssText="",t=this.el,l(t,e="is-hidden")||(t.className=""===t.className?e:t.className+" "+e),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"change",this._onChange),this._o.field&&(s(this._o.field,"change",this._onInputChange),this._o.bound&&(s(this._o.trigger,"click",this._onInputClick),s(this._o.trigger,"focus",this._onInputFocus),s(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},M})),t.Pikaday=this.Pikaday}),"@VERSION@",{affinity:"client"});YUI.add("hermes-template-search-photos-everyone-view",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(a=r(e,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"viewAll"):l,{name:"if",hash:{},fn:n.program(2,o,0),inverse:n.program(10,o,0),data:o,loc:{start:{line:2,column:1},end:{line:10,column:8}}}))?a:""},2:function(n,l,e,t,o){var a,r,s=null!=l?l:n.nullContext||{},i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t<div>\n\t\t\t<h5 class="search-results-header">'+(null!=(a=i(e,"unless").call(s,null!=l?i(l,"loading"):l,{name:"unless",hash:{},fn:n.program(3,o,0),inverse:n.noop,data:o,loc:{start:{line:4,column:37},end:{line:4,column:336}}}))?a:"")+n.escapeExpression("function"==typeof(r=null!=(r=i(e,"photoListTitle")||(null!=l?i(l,"photoListTitle"):l))?r:n.hooks.helperMissing)?r.call(s,{name:"photoListTitle",hash:{},data:o,loc:{start:{line:4,column:336},end:{line:4,column:354}}}):r)+(null!=(a=i(e,"if").call(s,null!=l?i(l,"loading"):l,{name:"if",hash:{},fn:n.program(8,o,0),inverse:n.noop,data:o,loc:{start:{line:4,column:354},end:{line:4,column:415}}}))?a:"")+"</h5>\n\t\t</div>\n"},3:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<span class="secondary">'+(null!=(a=r(e,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"isViewerSearchingSelf"):l,{name:"if",hash:{},fn:n.program(4,o,0),inverse:n.program(6,o,0),data:o,loc:{start:{line:4,column:80},end:{line:4,column:318}}}))?a:"")+"</span>"},4:function(n,l,e,t,o){var a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<a href="/photos/organize" class="search-to-organizr">'+n.escapeExpression((a(e,"intlHTMLMessage")||l&&a(l,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlHTMLMessage",hash:{count:null!=l?a(l,"photoCount"):l,intlName:"search.RESULTS_COUNT"},data:o,loc:{start:{line:4,column:163},end:{line:4,column:231}}}))+"</a>"},6:function(n,l,e,t,o){var a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression((a(e,"intlHTMLMessage")||l&&a(l,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlHTMLMessage",hash:{count:null!=l?a(l,"photoCount"):l,intlName:"search.RESULTS_COUNT"},data:o,loc:{start:{line:4,column:243},end:{line:4,column:311}}}))},8:function(n,l,e,t,o){return' <div class="flickr-dots inline"></div>'},10:function(n,l,e,t,o){var a,r,s=null!=l?l:n.nullContext||{},i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t<div>\n\t\t\t<h5 class="search-results-header">'+(null!=(a=i(e,"unless").call(s,null!=l?i(l,"loading"):l,{name:"unless",hash:{},fn:n.program(11,o,0),inverse:n.noop,data:o,loc:{start:{line:8,column:37},end:{line:8,column:252}}}))?a:"")+n.escapeExpression("function"==typeof(r=null!=(r=i(e,"photoListTitle")||(null!=l?i(l,"photoListTitle"):l))?r:n.hooks.helperMissing)?r.call(s,{name:"photoListTitle",hash:{},data:o,loc:{start:{line:8,column:252},end:{line:8,column:270}}}):r)+(null!=(a=i(e,"if").call(s,null!=l?i(l,"loading"):l,{name:"if",hash:{},fn:n.program(8,o,0),inverse:n.noop,data:o,loc:{start:{line:8,column:270},end:{line:8,column:331}}}))?a:"")+"</h5>\n\t\t</div>\n"},11:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(a=r(e,"unless").call(null!=l?l:n.nullContext||{},null!=l?r(l,"singleResult"):l,{name:"unless",hash:{},fn:n.program(12,o,0),inverse:n.noop,data:o,loc:{start:{line:8,column:56},end:{line:8,column:241}}}))?a:""},12:function(n,l,e,t,o){var a,r=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,i=n.escapeExpression,u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<a href="'+i("function"==typeof(a=null!=(a=u(e,"viewAllLink")||(null!=l?u(l,"viewAllLink"):l))?a:s)?a.call(r,{name:"viewAllLink",hash:{},data:o,loc:{start:{line:8,column:89},end:{line:8,column:104}}}):a)+'" class="view-more-link" data-track="search-viewall">'+i((u(e,"intlHTMLMessage")||l&&u(l,"intlHTMLMessage")||s).call(r,{name:"intlHTMLMessage",hash:{count:null!=l?u(l,"photoCount"):l,intlName:"search.VIEW_ALL_COUNT"},data:o,loc:{start:{line:8,column:157},end:{line:8,column:226}}}))+"</a>"},14:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(a=r(e,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"validResults"):l,{name:"if",hash:{},fn:n.program(15,o,0),inverse:n.noop,data:o,loc:{start:{line:13,column:1},end:{line:15,column:8}}}))?a:""},15:function(n,l,e,t,o){var a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t"+n.escapeExpression((a(e,"outlet")||l&&a(l,"outlet")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},null!=l?a(l,"photo-list-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:14,column:2},end:{line:14,column:28}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(n,l,e,t,o){var a,r=null!=l?l:n.nullContext||{},s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return(null!=(a=s(e,"if").call(r,null!=l?s(l,"validResults"):l,{name:"if",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:1,column:0},end:{line:11,column:7}}}))?a:"")+(null!=(a=s(e,"unless").call(r,null!=l?s(l,"loading"):l,{name:"unless",hash:{},fn:n.program(14,o,0),inverse:n.noop,data:o,loc:{start:{line:12,column:0},end:{line:16,column:11}}}))?a:"")},useData:!0}),t={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(t[l]=e)})),n.Template.register("hermes/search-photos-everyone-view",(function(l,o){return(o=o||{}).partials=o.partials?n.merge(t,o.partials):t,e(l,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-dynamic-page-head",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta name="title" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"title")||(null!=l?r(l,"title"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:1,column:41},end:{line:1,column:50}}}):a)+'" data-dynamic="true">'},3:function(n,l,e,t,o){var a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta name="description" content="'+n.escapeExpression((a(e,"stripTags")||l&&a(l,"stripTags")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},null!=l?a(l,"description"):l,{name:"stripTags",hash:{},data:o,loc:{start:{line:2,column:53},end:{line:2,column:78}}}))+'" data-dynamic="true">'},5:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(a=r(e,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"oembedURL"):l,{name:"if",hash:{},fn:n.program(6,o,0),inverse:n.program(8,o,0),data:o,loc:{start:{line:5,column:0},end:{line:11,column:7}}}))?a:""},6:function(n,l,e,t,o){var a,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u="function",c=n.escapeExpression,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<link rel="alternate" type="application/json+oembed" href="https://www.flickr.com/services/oembed/?format=json&url='+c(typeof(a=null!=(a=p(e,"oembedURL")||(null!=l?p(l,"oembedURL"):l))?a:i)===u?a.call(r,{name:"oembedURL",hash:{},data:o,loc:{start:{line:6,column:115},end:{line:6,column:128}}}):a)+'" title="'+c(typeof(a=null!=(a=p(e,"title")||(null!=l?p(l,"title"):l))?a:i)===u?a.call(r,{name:"title",hash:{},data:o,loc:{start:{line:6,column:137},end:{line:6,column:146}}}):a)+'">\n<link rel="alternate" type="application/xml+oembed" href="https://www.flickr.com/services/oembed/?format=xml&url='+c(typeof(a=null!=(a=p(e,"oembedURL")||(null!=l?p(l,"oembedURL"):l))?a:i)===u?a.call(r,{name:"oembedURL",hash:{},data:o,loc:{start:{line:7,column:113},end:{line:7,column:126}}}):a)+'" title="'+c(typeof(a=null!=(a=p(e,"title")||(null!=l?p(l,"title"):l))?a:i)===u?a.call(r,{name:"title",hash:{},data:o,loc:{start:{line:7,column:135},end:{line:7,column:144}}}):a)+'">\n'},8:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(a=r(e,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"fullURL"):l,{name:"if",hash:{},fn:n.program(9,o,0),inverse:n.noop,data:o,loc:{start:{line:8,column:0},end:{line:11,column:0}}}))?a:""},9:function(n,l,e,t,o){var a,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u="function",c=n.escapeExpression,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<link rel="alternate" type="application/json+oembed" href="https://www.flickr.com/services/oembed/?format=json&url='+c(typeof(a=null!=(a=p(e,"fullURL")||(null!=l?p(l,"fullURL"):l))?a:i)===u?a.call(r,{name:"fullURL",hash:{},data:o,loc:{start:{line:9,column:115},end:{line:9,column:126}}}):a)+'" title="'+c(typeof(a=null!=(a=p(e,"title")||(null!=l?p(l,"title"):l))?a:i)===u?a.call(r,{name:"title",hash:{},data:o,loc:{start:{line:9,column:135},end:{line:9,column:144}}}):a)+'">\n<link rel="alternate" type="application/xml+oembed" href="https://www.flickr.com/services/oembed/?format=xml&url='+c(typeof(a=null!=(a=p(e,"fullURL")||(null!=l?p(l,"fullURL"):l))?a:i)===u?a.call(r,{name:"fullURL",hash:{},data:o,loc:{start:{line:10,column:113},end:{line:10,column:124}}}):a)+'" title="'+c(typeof(a=null!=(a=p(e,"title")||(null!=l?p(l,"title"):l))?a:i)===u?a.call(r,{name:"title",hash:{},data:o,loc:{start:{line:10,column:133},end:{line:10,column:142}}}):a)+'">\n'},11:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:title" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"title")||(null!=l?r(l,"title"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:14,column:48},end:{line:14,column:57}}}):a)+'" data-dynamic="true">'},13:function(n,l,e,t,o){var a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:description" content="'+n.escapeExpression((a(e,"stripTags")||l&&a(l,"stripTags")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},null!=l?a(l,"description"):l,{name:"stripTags",hash:{},data:o,loc:{start:{line:15,column:60},end:{line:15,column:85}}}))+'" data-dynamic="true">'},15:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:type" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"ogType")||(null!=l?r(l,"ogType"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"ogType",hash:{},data:o,loc:{start:{line:16,column:48},end:{line:16,column:58}}}):a)+'" data-dynamic="true">'},17:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:url" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"fullURL")||(null!=l?r(l,"fullURL"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"fullURL",hash:{},data:o,loc:{start:{line:17,column:48},end:{line:17,column:59}}}):a)+'" data-dynamic="true">'},19:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="article:author" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"ownerURL")||(null!=l?r(l,"ownerURL"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"ownerURL",hash:{},data:o,loc:{start:{line:18,column:57},end:{line:18,column:69}}}):a)+'" data-dynamic="true">'},21:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(a=r(e,"unless").call(null!=l?l:n.nullContext||{},null!=l?r(l,"extraOpenGraphImages"):l,{name:"unless",hash:{},fn:n.program(22,o,0),inverse:n.noop,data:o,loc:{start:{line:20,column:0},end:{line:24,column:11}}}))?a:""},22:function(n,l,e,t,o){var a,r,i=null!=l?l:n.nullContext||{},u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:image" content="'+n.escapeExpression("function"==typeof(r=null!=(r=u(e,"openGraphImageURL")||(null!=l?u(l,"openGraphImageURL"):l))?r:n.hooks.helperMissing)?r.call(i,{name:"openGraphImageURL",hash:{},data:o,loc:{start:{line:21,column:35},end:{line:21,column:56}}}):r)+'" data-dynamic="true">\n'+(null!=(a=u(e,"if").call(i,null!=l?u(l,"openGraphImageWidth"):l,{name:"if",hash:{},fn:n.program(23,o,0),inverse:n.noop,data:o,loc:{start:{line:22,column:0},end:{line:22,column:120}}}))?a:"")+"\n"+(null!=(a=u(e,"if").call(i,null!=l?u(l,"openGraphImageHeight"):l,{name:"if",hash:{},fn:n.program(25,o,0),inverse:n.noop,data:o,loc:{start:{line:23,column:0},end:{line:23,column:123}}}))?a:"")+"\n"},23:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:image:width" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"openGraphImageWidth")||(null!=l?r(l,"openGraphImageWidth"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"openGraphImageWidth",hash:{},data:o,loc:{start:{line:22,column:68},end:{line:22,column:91}}}):a)+'" data-dynamic="true">'},25:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:image:height" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"openGraphImageHeight")||(null!=l?r(l,"openGraphImageHeight"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"openGraphImageHeight",hash:{},data:o,loc:{start:{line:23,column:70},end:{line:23,column:94}}}):a)+'" data-dynamic="true">'},27:function(n,l,e,t,o){var a,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u="function",c=n.escapeExpression,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="og:image" content="'+c(typeof(a=null!=(a=p(e,"url")||(null!=l?p(l,"url"):l))?a:i)===u?a.call(r,{name:"url",hash:{},data:o,loc:{start:{line:27,column:35},end:{line:27,column:42}}}):a)+'" data-dynamic="true">\n<meta property="og:image:width" content="'+c(typeof(a=null!=(a=p(e,"width")||(null!=l?p(l,"width"):l))?a:i)===u?a.call(r,{name:"width",hash:{},data:o,loc:{start:{line:28,column:41},end:{line:28,column:50}}}):a)+'" data-dynamic="true">\n<meta property="og:image:height" content="'+c(typeof(a=null!=(a=p(e,"height")||(null!=l?p(l,"height"):l))?a:i)===u?a.call(r,{name:"height",hash:{},data:o,loc:{start:{line:29,column:42},end:{line:29,column:52}}}):a)+'" data-dynamic="true">\n'},29:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="al:ios:url" content="flickr://flickr.com'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"url")||(null!=l?r(l,"url"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"url",hash:{},data:o,loc:{start:{line:32,column:67},end:{line:32,column:74}}}):a)+'" data-dynamic="true">'},31:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:card" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"twitterCardType")||(null!=l?r(l,"twitterCardType"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"twitterCardType",hash:{},data:o,loc:{start:{line:34,column:62},end:{line:34,column:81}}}):a)+'" data-dynamic="true">'},33:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:player" content="https://embedr.flickr.com'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"embedUrl")||(null!=l?r(l,"embedUrl"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"embedUrl",hash:{},data:o,loc:{start:{line:36,column:66},end:{line:36,column:78}}}):a)+'" data-dynamic="true">\n<meta property="twitter:player:width" content="640" data-dynamic="true">\n<meta property="twitter:player:height" content="480" data-dynamic="true">\n'},35:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:title" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"title")||(null!=l?r(l,"title"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:40,column:53},end:{line:40,column:62}}}):a)+'" data-dynamic="true">'},37:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:image" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"openGraphImageURL")||(null!=l?r(l,"openGraphImageURL"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"openGraphImageURL",hash:{},data:o,loc:{start:{line:41,column:65},end:{line:41,column:86}}}):a)+'" data-dynamic="true">'},39:function(n,l,e,t,o){var a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:description" content="'+n.escapeExpression((a(e,"stripTags")||l&&a(l,"stripTags")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},null!=l?a(l,"description"):l,{name:"stripTags",hash:{},data:o,loc:{start:{line:42,column:65},end:{line:42,column:90}}}))+'" data-dynamic="true">'},41:function(n,l,e,t,o){var a,r,i=null!=l?l:n.nullContext||{},u=n.hooks.helperMissing,c="function",p=n.escapeExpression,s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:app:url:iphone" content="flickr://flickr.com'+p(typeof(r=null!=(r=s(e,"url")||(null!=l?s(l,"url"):l))?r:u)===c?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:44,column:68},end:{line:44,column:75}}}):r)+'" data-dynamic="true">\n<meta property="twitter:app:url:ipad" content="flickr://flickr.com'+p(typeof(r=null!=(r=s(e,"url")||(null!=l?s(l,"url"):l))?r:u)===c?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:45,column:66},end:{line:45,column:73}}}):r)+'" data-dynamic="true">\n'+(null!=(a=s(e,"if").call(i,null!=l?s(l,"fullURL"):l,{name:"if",hash:{},fn:n.program(42,o,0),inverse:n.noop,data:o,loc:{start:{line:46,column:0},end:{line:46,column:108}}}))?a:"")+"\n"},42:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<meta property="twitter:app:url:googleplay" content="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"fullURL")||(null!=l?r(l,"fullURL"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"fullURL",hash:{},data:o,loc:{start:{line:46,column:68},end:{line:46,column:79}}}):a)+'" data-dynamic="true">'},44:function(n,l,e,t,o){var a,r,i=null!=l?l:n.nullContext||{},u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<link rel="alternate" type="application/atom+xml" '+(null!=(a=u(e,"if").call(i,null!=l?u(l,"title"):l,{name:"if",hash:{},fn:n.program(45,o,0),inverse:n.noop,data:o,loc:{start:{line:49,column:65},end:{line:49,column:102}}}))?a:"")+' href="'+n.escapeExpression("function"==typeof(r=null!=(r=u(e,"url")||(null!=l?u(l,"url"):l))?r:n.hooks.helperMissing)?r.call(i,{name:"url",hash:{},data:o,loc:{start:{line:49,column:109},end:{line:49,column:116}}}):r)+'" data-dynamic="true">'},45:function(n,l,e,t,o){var a,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'title="'+n.escapeExpression("function"==typeof(a=null!=(a=r(e,"title")||(null!=l?r(l,"title"):l))?a:n.hooks.helperMissing)?a.call(null!=l?l:n.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:49,column:85},end:{line:49,column:94}}}):a)+'"'},compiler:[8,">= 4.3.0"],main:function(n,l,e,t,o){var a,r=null!=l?l:n.nullContext||{},i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return(null!=(a=i(e,"if").call(r,null!=l?i(l,"title"):l,{name:"if",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:1,column:0},end:{line:1,column:79}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"description"):l,{name:"if",hash:{},fn:n.program(3,o,0),inverse:n.noop,data:o,loc:{start:{line:2,column:0},end:{line:2,column:107}}}))?a:"")+"\n\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"title"):l,{name:"if",hash:{},fn:n.program(5,o,0),inverse:n.noop,data:o,loc:{start:{line:4,column:0},end:{line:12,column:7}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"title"):l,{name:"if",hash:{},fn:n.program(11,o,0),inverse:n.noop,data:o,loc:{start:{line:14,column:0},end:{line:14,column:86}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"description"):l,{name:"if",hash:{},fn:n.program(13,o,0),inverse:n.noop,data:o,loc:{start:{line:15,column:0},end:{line:15,column:114}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"ogType"):l,{name:"if",hash:{},fn:n.program(15,o,0),inverse:n.noop,data:o,loc:{start:{line:16,column:0},end:{line:16,column:87}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"fullURL"):l,{name:"if",hash:{},fn:n.program(17,o,0),inverse:n.noop,data:o,loc:{start:{line:17,column:0},end:{line:17,column:88}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"ownerURL"):l,{name:"if",hash:{},fn:n.program(19,o,0),inverse:n.noop,data:o,loc:{start:{line:18,column:0},end:{line:18,column:98}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"openGraphImageURL"):l,{name:"if",hash:{},fn:n.program(21,o,0),inverse:n.noop,data:o,loc:{start:{line:19,column:0},end:{line:25,column:7}}}))?a:"")+(null!=(a=i(e,"each").call(r,null!=l?i(l,"extraOpenGraphImages"):l,{name:"each",hash:{},fn:n.program(27,o,0),inverse:n.noop,data:o,loc:{start:{line:26,column:0},end:{line:30,column:9}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"url"):l,{name:"if",hash:{},fn:n.program(29,o,0),inverse:n.noop,data:o,loc:{start:{line:32,column:0},end:{line:32,column:103}}}))?a:"")+"\n\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"twitterCardType"):l,{name:"if",hash:{},fn:n.program(31,o,0),inverse:n.noop,data:o,loc:{start:{line:34,column:0},end:{line:34,column:110}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"embedUrl"):l,{name:"if",hash:{},fn:n.program(33,o,0),inverse:n.noop,data:o,loc:{start:{line:35,column:0},end:{line:39,column:7}}}))?a:"")+(null!=(a=i(e,"if").call(r,null!=l?i(l,"title"):l,{name:"if",hash:{},fn:n.program(35,o,0),inverse:n.noop,data:o,loc:{start:{line:40,column:0},end:{line:40,column:91}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"openGraphImageURL"):l,{name:"if",hash:{},fn:n.program(37,o,0),inverse:n.noop,data:o,loc:{start:{line:41,column:0},end:{line:41,column:115}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"description"):l,{name:"if",hash:{},fn:n.program(39,o,0),inverse:n.noop,data:o,loc:{start:{line:42,column:0},end:{line:42,column:119}}}))?a:"")+"\n"+(null!=(a=i(e,"if").call(r,null!=l?i(l,"url"):l,{name:"if",hash:{},fn:n.program(41,o,0),inverse:n.noop,data:o,loc:{start:{line:43,column:0},end:{line:47,column:7}}}))?a:"")+"\n"+(null!=(a=i(e,"each").call(r,null!=l?i(l,"feeds"):l,{name:"each",hash:{},fn:n.program(44,o,0),inverse:n.noop,data:o,loc:{start:{line:49,column:0},end:{line:49,column:147}}}))?a:"")+"\n"},useData:!0}),t={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(t[l]=e)})),n.Template.register("hermes/dynamic-page-head",(function(l,o){return(o=o||{}).partials=o.partials?n.merge(t,o.partials):t,e(l,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-photos-everyone-view",(function(e){var t={"photo-models":{name:"photo-list-photo-view",params:{excludePeople:!0}},"photo-lite-models":{name:"photo-list-photo-view",params:{excludePeople:!0}}},i={jst:{rowHeight:170,subviewMapping:t},thm:{rowHeight:120,forceAspectRatio:1,subviewMapping:t},til:{rowHeight:210,forceAspectRatio:1,loadMoreMargin:5,subviewMapping:{"photo-models":{name:"photo-list-tile-view",params:{excludePeople:!0,showDescription:!1}},"photo-lite-models":{name:"photo-list-tile-view",params:{excludePeople:!0,showDescription:!1}}}},desc:{rowHeight:210,itemSpacing:{horizontal:4,vertical:70},subviewMapping:{"photo-models":{name:"photo-list-description-view"},"photo-lite-models":{name:"photo-list-description-view"}}}};e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var a,o,s,r,h,l;if(h=t.rowHeightMod||1,"til"===t.viewType&&(h=Math.max(1,t.rowHeightMod)),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-photos-everyone-view",{loading:!0}),t.viewType||(t.viewType="jst"),this.unifiedSubviewParams=t.unifiedSubviewParams||{},this.unifiedSubviewParams.everyone&&this.unifiedSubviewParams.everyone.fetchParams?(this.fetchParams=this.unifiedSubviewParams.everyone.fetchParams,this.apiParams=e.merge(this.fetchParams.apiParams||{}),this.searchId=this.unifiedSubviewParams.everyone.id):(this.apiParams={},this.fetchParams={}),this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PHOTOS),a=i[t.viewType].forceAspectRatio,o=i[t.viewType].loadMoreMargin,s=e.clone(i[t.viewType].subviewMapping),r=e.clone(i[t.viewType].itemSpacing),this.apiFailed=t.apiFailed,t.photoListConfig={modelParams:{registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchId||this.searchUrl.getId(),collectionAttributeName:"photos",fetchParams:this.fetchParams},pageParams:{page:1,perPage:50,perPageDoubling:1},parentName:this.name,loadMoreMargin:3,engagementModelName:"photo-lite-models",injectPhotolistContextParams:{rapidBeaconConfig:{beaconName:"searchPhotoResultClick",itemIndexKey:"vespaRnk",searchSection:"photos-everyone",searchTerm:t.searchTerm}},measureAFT:!0,mobileLayout:t.allowMobileLayout?{}:null,scrollInterruptParams:{pageCounts:[5],footerToHideWhileScrolling:".footer-full-view"},layout:{containerPadding:{top:0,right:0,bottom:8,left:0},targetRowHeight:i[t.viewType].rowHeight*h,awakeBoundsToViewportSizeRatio:5},allowLazyLoading:!0},a&&(t.photoListConfig.layout.forceAspectRatio=a),o&&(t.photoListConfig.layout.loadMoreMargin=o),s&&(t.photoListConfig.subviewMapping=s,this.searchUrl.getAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll)&&this.searchUrl.getAPIParam(e.SearchHelper.API.userId)||t.suppressExcludePeople))for(l in s)t.photoListConfig.subviewMapping[l].params&&(t.photoListConfig.subviewMapping[l].params.excludePeople=!1);return r&&(t.photoListConfig.layout.itemSpacing=r),t.viewType===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified&&(t.photoListConfig.layout.itemSpacing={horizontal:4,vertical:4}),this.rowHeightMod=t.rowHeightMod,this.appContext.flipper.isFlipped("enable-search-to-organizr")&&t.modelParams.viewerNsid===t.modelParams.apiParams.user_id&&(this.isViewerSearchingSelf=!0),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return this.apiFailed}}},loadState:function(){var t=this;return this.apiFailed?e.Promise.resolve():this.appContext.getModel("search-photos-lite-models",this.searchId||this.searchUrl.getId(),this.fetchParams).then((function(i){return t.searchModel=i,e.SearchHelper.deriveScopeTitle(t.apiParams,t.appContext)})).then((function(e){t.scopeTitle=t.intlMessage(e)}))},buildContainer:function(){return this.setContainerWithTemplate("search-photos-everyone-view",{validResults:this.searchModel&&this.searchModel.getValue("totalItems")>0,photoListTitle:this.scopeTitle,viewAllLink:this.searchUrl.clone().setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll,!0).getURL(),photoCount:this.apiFailed?"":this.searchModel.getValue("totalItems"),singleResult:!this.apiFailed&&1===this.searchModel.getValue("totalItems"),"photo-list-view":this.apiFailed?"":this.subviews["photo-list-view"].get("container"),viewAll:this.apiParams[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll],isViewerSearchingSelf:this.isViewerSearchingSelf}),this},buildHeadContainer:function(){var t,i,a=this.searchModel,o=a?a.getValue("photos").getList():[],s=this.intlMessage({intlName:"search.FLICKR_SEARCH"})+(this.apiParams.text?" — “"+this.apiParams.text+"”":"");t=o.length>0?o[0].getSizeToFit({width:640,height:480}):{},i=this.templates("dynamic-page-head")({title:s,url:this.searchUrl.getURL(),embedUrl:this.searchUrl.getURL(),oembedURL:this.searchUrl?encodeURIComponent(e.url(this.searchUrl.getURL())):null,fullURL:this.searchUrl?e.url(this.searchUrl.getURL()):null,openGraphImageURL:t.url?e.URLHelper.addProtocolToURL(t.url):null,openGraphImageWidth:t.width,openGraphImageHeight:t.height,ownerURL:e.url(),ogType:"article",twitterCardType:"player"}),i+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, viewport-fit=cover, initial-scale=1, maximum-scale=1"}),this.subviews["photo-list-view"]?this.set("headContainer",i.concat(this.subviews["photo-list-view"].get("headContainer"))):this.set("headContainer",i),YUI.Env.isServer||this.updateHead()},activate:function(){return this.isViewerSearchingSelf&&this.get("container").one(".search-to-organizr").on("click",this.onEditInOrganizrClick.bind(this)),e.Snowplough&&e.Snowplough.sendSearchEvent({keyword:this.apiParams.text,category:"photos",totalResults:this.searchModel?this.searchModel.getValue("totalItems"):0,pageResults:this.searchModel?this.searchModel.getValue("photos").getList().length:0}),this},onParentViewEvent:function(e,t){if("search:layoutChange"===(t&&t.length&&t[0]))t[1]&&this.handleLayoutChange(t[1])},handleLayoutChange:function(t){var a=this.subviews["photo-list-view"],o=a.photoListLayout,s=i[t].forceAspectRatio,r=i[t].loadMoreMargin,h=e.clone(i[t].subviewMapping),l=this.rowHeightMod;i.hasOwnProperty(t)&&("til"===t&&(l=Math.max(1,l)),o.targetRowHeight=i[t].rowHeight*l,o.forceAspectRatio=s,o.loadMoreMargin=r,a.subviewMapping=h,a.setItems(this.searchModel.getValue("photos").getList()))},onEditInOrganizrClick:function(e){e.preventDefault(),e.stopPropagation();let t=[];this.isViewerSearchingSelf&&(this.searchModel.getValue("totalItems")>0&&this.searchModel.getValue("photos").getList().forEach((function(e){t.push(e.id)})),this.appContext.flapp.navigate("/photos/organize?ids="+t.join(",")))}})}),"@VERSION@",{requires:["flickr-view","photo-list-view","flickr-promise","search-url","hermes-template-search-photos-everyone-view","hermes-template-dynamic-page-head","hermes-template-head-meta","search-helper","flutil","search-photos-lite-models","person-preferences-models","url","url-helper"],langBundles:["search"]});YUI.add("hermes-template-ad-rail-card",(function(a,e){var r=a.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(a,e,r,l,t){var n,i=a.lookupProperty||function(a,e){if(Object.prototype.hasOwnProperty.call(a,e))return a[e]};return'<div class="ad-rail-card">\n\t<div class="ad-rail-content-container">\n'+(null!=(n=a.invokePartial(i(l,"prbd-moola-position"),e,{name:"prbd-moola-position",hash:{upgradeProLink:null!=(n=null!=e?i(e,"adConfig"):e)?i(n,"upgradeProLink"):n,upsellFallback:null!=e?i(e,"upsellFallback"):e,adUnit:null!=(n=null!=e?i(e,"adConfig"):e)?i(n,"adUnit"):n},data:t,indent:"\t\t",helpers:r,partials:l,decorators:a.decorators}))?n:"")+"\t</div>\n</div>\n"},usePartial:!0,useData:!0}),l={};a.Array.each(["prbd-moola-position"],(function(e){var r=a.Template.get("hermes/"+e);r&&(l[e]=r)})),a.Template.register("hermes/ad-rail-card",(function(e,t){return(t=t||{}).partials=t.partials?a.merge(l,t.partials):l,r(e,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-prbd-moola-position"]});