YUI.add("hermes-template-coverphoto-stats",(function(l,n){var e=l.Template.Handlebars.revive({1:function(l,n,e,o,t){var a,r=null!=n?n:l.nullContext||{},i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return(null!=(a=i(e,"if").call(r,null!=n?i(n,"contacts"):n,{name:"if",hash:{},fn:l.program(2,t,0),inverse:l.noop,data:t,loc:{start:{line:3,column:2},end:{line:13,column:9}}}))?a:"")+(null!=(a=i(e,"if").call(r,null!=n?i(n,"groupsStats"):n,{name:"if",hash:{},fn:l.program(10,t,0),inverse:l.noop,data:t,loc:{start:{line:14,column:2},end:{line:20,column:9}}}))?a:"")},2:function(l,n,e,o,t){var a,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(a=r(e,"if").call(null!=n?n:l.nullContext||{},null!=n?r(n,"viewingSelf"):n,{name:"if",hash:{},fn:l.program(3,t,0),inverse:l.program(5,t,0),data:t,loc:{start:{line:4,column:3},end:{line:12,column:10}}}))?a:""},3:function(l,n,e,o,t){var a,r=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,u="function",s=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t\t\t<p class="followers truncate no-shrink"><a href="'+s(typeof(a=null!=(a=c(e,"followerUrl")||(null!=n?c(n,"followerUrl"):n))?a:i)===u?a.call(r,{name:"followerUrl",hash:{},data:t,loc:{start:{line:5,column:53},end:{line:5,column:68}}}):a)+'">'+s(typeof(a=null!=(a=c(e,"followerString")||(null!=n?c(n,"followerString"):n))?a:i)===u?a.call(r,{name:"followerString",hash:{},data:t,loc:{start:{line:5,column:70},end:{line:5,column:88}}}):a)+'</a><em>&bull;</em><a href="'+s(typeof(a=null!=(a=c(e,"followingUrl")||(null!=n?c(n,"followingUrl"):n))?a:i)===u?a.call(r,{name:"followingUrl",hash:{},data:t,loc:{start:{line:5,column:116},end:{line:5,column:132}}}):a)+'">'+s(typeof(a=null!=(a=c(e,"followingString")||(null!=n?c(n,"followingString"):n))?a:i)===u?a.call(r,{name:"followingString",hash:{},data:t,loc:{start:{line:5,column:134},end:{line:5,column:153}}}):a)+"</a></p>\n"},5:function(l,n,e,o,t){var a,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(a=(r(e,"ifCond")||n&&r(n,"ifCond")||l.hooks.helperMissing).call(null!=n?n:l.nullContext||{},null!=n?r(n,"followingCount"):n,">",0,{name:"ifCond",hash:{},fn:l.program(6,t,0),inverse:l.program(8,t,0),data:t,loc:{start:{line:7,column:4},end:{line:11,column:15}}}))?a:""},6:function(l,n,e,o,t){var a,r=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,u="function",s=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t\t\t\t<p class="followers truncate no-shrink">'+s(typeof(a=null!=(a=c(e,"followerString")||(null!=n?c(n,"followerString"):n))?a:i)===u?a.call(r,{name:"followerString",hash:{},data:t,loc:{start:{line:8,column:45},end:{line:8,column:63}}}):a)+'<em>&bull;</em><a href="'+s(typeof(a=null!=(a=c(e,"followingUrl")||(null!=n?c(n,"followingUrl"):n))?a:i)===u?a.call(r,{name:"followingUrl",hash:{},data:t,loc:{start:{line:8,column:87},end:{line:8,column:103}}}):a)+'">'+s(typeof(a=null!=(a=c(e,"followingString")||(null!=n?c(n,"followingString"):n))?a:i)===u?a.call(r,{name:"followingString",hash:{},data:t,loc:{start:{line:8,column:105},end:{line:8,column:124}}}):a)+"</a></p>\n"},8:function(l,n,e,o,t){var a,r=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,u="function",s=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t\t\t\t<p class="followers truncate no-shrink">'+s(typeof(a=null!=(a=c(e,"followerString")||(null!=n?c(n,"followerString"):n))?a:i)===u?a.call(r,{name:"followerString",hash:{},data:t,loc:{start:{line:10,column:45},end:{line:10,column:63}}}):a)+"<em>&bull;</em>"+s(typeof(a=null!=(a=c(e,"followingString")||(null!=n?c(n,"followingString"):n))?a:i)===u?a.call(r,{name:"followingString",hash:{},data:t,loc:{start:{line:10,column:78},end:{line:10,column:97}}}):a)+"</p>\n"},10:function(l,n,e,o,t){var a,r=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,u="function",s=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t\t<div class="group-statistics no-shrink">\n\t\t\t\t<p class="followers truncate"><a href="'+s(typeof(a=null!=(a=c(e,"membersLink")||(null!=n?c(n,"membersLink"):n))?a:i)===u?a.call(r,{name:"membersLink",hash:{},data:t,loc:{start:{line:16,column:43},end:{line:16,column:58}}}):a)+'">'+s(typeof(a=null!=(a=c(e,"members")||(null!=n?c(n,"members"):n))?a:i)===u?a.call(r,{name:"members",hash:{},data:t,loc:{start:{line:16,column:60},end:{line:16,column:71}}}):a)+" "+s((c(e,"intlMessage")||n&&c(n,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"header.MEMBERS"},data:t,loc:{start:{line:16,column:72},end:{line:16,column:113}}}))+'</a><em>&bull;</em></p>\n\t\t\t\t<p class="followers truncate"><a href="'+s(typeof(a=null!=(a=c(e,"poolLink")||(null!=n?c(n,"poolLink"):n))?a:i)===u?a.call(r,{name:"poolLink",hash:{},data:t,loc:{start:{line:17,column:43},end:{line:17,column:55}}}):a)+'">'+s(typeof(a=null!=(a=c(e,"photosText")||(null!=n?c(n,"photosText"):n))?a:i)===u?a.call(r,{name:"photosText",hash:{},data:t,loc:{start:{line:17,column:57},end:{line:17,column:71}}}):a)+'</a><em>&bull;</em></p>\n\t\t\t\t<p class="followers truncate"><a href="'+s(typeof(a=null!=(a=c(e,"discussionsLink")||(null!=n?c(n,"discussionsLink"):n))?a:i)===u?a.call(r,{name:"discussionsLink",hash:{},data:t,loc:{start:{line:18,column:43},end:{line:18,column:62}}}):a)+'"> '+s(typeof(a=null!=(a=c(e,"topicCount")||(null!=n?c(n,"topicCount"):n))?a:i)===u?a.call(r,{name:"topicCount",hash:{},data:t,loc:{start:{line:18,column:65},end:{line:18,column:79}}}):a)+" "+s((c(e,"intlMessage")||n&&c(n,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"header.DISCUSSIONS"},data:t,loc:{start:{line:18,column:80},end:{line:18,column:125}}}))+"</a></p>\n\t\t\t</div>\n"},compiler:[8,">= 4.3.0"],main:function(l,n,e,o,t){var a,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'<div class="coverphoto-stats">\n'+(null!=(a=r(e,"each").call(null!=n?n:l.nullContext||{},null!=n?r(n,"metadata"):n,{name:"each",hash:{},fn:l.program(1,t,0),inverse:l.noop,data:t,loc:{start:{line:2,column:1},end:{line:21,column:10}}}))?a:"")+"</div>\n"},useData:!0}),o={};l.Array.each([],(function(n){var e=l.Template.get("hermes/"+n);e&&(o[n]=e)})),l.Template.register("hermes/coverphoto-stats",(function(n,t){return(t=t||{}).partials=t.partials?l.merge(o,t.partials):o,e(n,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-coverphoto-additional-meta",(function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"hasLocation"):e,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.noop,data:a,loc:{start:{line:3,column:2},end:{line:3,column:94}}}))?o:"")+"\n\t\t"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"photos"):e,{name:"if",hash:{},fn:n.program(4,a,0),inverse:n.noop,data:a,loc:{start:{line:4,column:2},end:{line:4,column:122}}}))?o:"")+"\n\t\t"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"memberSince"):e,{name:"if",hash:{},fn:n.program(6,a,0),inverse:n.noop,data:a,loc:{start:{line:5,column:2},end:{line:5,column:119}}}))?o:"")+"\n\t\t"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"groupSince"):e,{name:"if",hash:{},fn:n.program(8,a,0),inverse:n.noop,data:a,loc:{start:{line:6,column:2},end:{line:6,column:167}}}))?o:"")+"\n"},2:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<p class="metadata-item truncate cp-location loc">'+n.escapeExpression("function"==typeof(o=null!=(o=r(l,"location")||(null!=e?r(e,"location"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"location",hash:{},data:a,loc:{start:{line:3,column:71},end:{line:3,column:83}}}):o)+"</p>"},4:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<p class="metadata-item photo-count">'+n.escapeExpression((o(l,"intlMessage")||e&&o(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{count:null!=e?o(e,"count"):e,intlName:"header.COUNT_PHOTOS"},data:a,loc:{start:{line:4,column:53},end:{line:4,column:111}}}))+"</p>"},6:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<p class="metadata-item joined">'+n.escapeExpression((o(l,"intlMessage")||e&&o(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{year:null!=e?o(e,"date"):e,intlName:"header.JOINED_YEAR"},data:a,loc:{start:{line:5,column:53},end:{line:5,column:108}}}))+"</p>"},8:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<p class="metadata-item">'+s("function"==typeof(o=null!=(o=c(l,"count")||(null!=e?c(e,"count"):e))?o:i)?o.call(r,{name:"count",hash:{},data:a,loc:{start:{line:6,column:45},end:{line:6,column:54}}}):o)+" "+s((c(l,"intlMessage")||e&&c(e,"intlMessage")||i).call(r,{name:"intlMessage",hash:{intlName:"header.GROUP_SINCE"},data:a,loc:{start:{line:6,column:55},end:{line:6,column:100}}}))+" "+s((c(l,"intlMessage")||e&&c(e,"intlMessage")||i).call(r,{name:"intlMessage",hash:{mdyDate:null!=e?c(e,"date"):e,intlName:"header.MDY_DATE"},data:a,loc:{start:{line:6,column:101},end:{line:6,column:156}}}))+"</p>"},compiler:[8,">= 4.3.0"],main:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="coverphoto-additional-meta">\n'+(null!=(o=r(l,"each").call(null!=e?e:n.nullContext||{},null!=e?r(e,"metadata"):e,{name:"each",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:7,column:10}}}))?o:"")+"</div>\n"},useData:!0}),t={};n.Array.each([],(function(e){var l=n.Template.get("hermes/"+e);l&&(t[e]=l)})),n.Template.register("hermes/coverphoto-additional-meta",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-coverphoto-editor-controls",(function(e,t){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,a,n,l){var o=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,r=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="coverphoto-editor-controls editor-controls">\n\t<button data-action="saveEdit" class="butt">'+r((i(a,"intlMessage")||t&&i(t,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"common.SAVE"},data:l,loc:{start:{line:2,column:45},end:{line:2,column:83}}}))+'</button>\n\t<button data-action="cancelEdit" class="butt alt">'+r((i(a,"intlMessage")||t&&i(t,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"common.CANCEL"},data:l,loc:{start:{line:3,column:51},end:{line:3,column:91}}}))+"</button>\n\t<p>"+r((i(a,"intlMessage")||t&&i(t,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:"header.COVER_PHOTO_SET_POSITION"},data:l,loc:{start:{line:4,column:4},end:{line:4,column:62}}}))+"</p>\n</div>\n"},useData:!0}),n={};e.Array.each([],(function(t){var a=e.Template.get("hermes/"+t);a&&(n[t]=a)})),e.Template.register("hermes/coverphoto-editor-controls",(function(t,l){return(l=l||{}).partials=l.partials?e.merge(n,l.partials):n,a(t,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-fluid-coverphoto",(function(t,o){var e=t.Template.Handlebars.revive({1:function(t,o,e,a,r){var n,l=t.lookupProperty||function(t,o){if(Object.prototype.hasOwnProperty.call(t,o))return t[o]};return'style="background-image:url('+t.escapeExpression(t.lambda(null!=(n=null!=(n=null!=o?l(o,"coverPhoto"):o)?l(n,"urls"):n)?l(n,"h"):n,o))+')"'},3:function(t,o,e,a,r){return'\t\t<div class="attribution-button">\n\t\t\t<svg class="icon icon-info_hollow"><use xlink:href="#icon-info_hollow"></use></svg>\n\t\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(t,o,e,a,r){var n,l=null!=o?o:t.nullContext||{},i=t.lookupProperty||function(t,o){if(Object.prototype.hasOwnProperty.call(t,o))return t[o]};return'<div class="coverphoto updates-flipped"\n\t'+(null!=(n=i(e,"if").call(l,null!=o?i(o,"coverPhoto"):o,{name:"if",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r,loc:{start:{line:2,column:1},end:{line:2,column:77}}}))?n:"")+'>\n\n\t<div class="coverphoto-gradient"></div>\n\n\n\t<div class="coverphoto-content fluid-centered desktop">\n'+(null!=(n=t.invokePartial(i(a,"coverphoto-avatar"),o,{name:"coverphoto-avatar",data:r,indent:"\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+'\n\t\t<div class="info-container">\n\t\t\t<div class="title-container">\n'+(null!=(n=t.invokePartial(i(a,"coverphoto-title"),o,{name:"coverphoto-title",data:r,indent:"\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+"\n\n"+(null!=(n=t.invokePartial(i(a,"coverphoto-actions"),null!=o?i(o,"actionData"):o,{name:"coverphoto-actions",data:r,indent:"\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+'\t\t\t</div>\n\n\t\t\t<div class="metadata-container">\n\t\t\t\t<div class="metadata-left">\n'+(null!=(n=t.invokePartial(i(a,"coverphoto-subtitle"),o,{name:"coverphoto-subtitle",data:r,indent:"\t\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+"\n"+(null!=(n=t.invokePartial(i(a,"coverphoto-stats"),o,{name:"coverphoto-stats",data:r,indent:"\t\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+'\t\t\t\t</div>\n\n\t\t\t\t<div class="metadata-right">\n'+(null!=(n=t.invokePartial(i(a,"coverphoto-additional-meta"),o,{name:"coverphoto-additional-meta",data:r,indent:"\t\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+'\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="coverphoto-content fluid-centered mobile">\n\t\t<div class="info-container">\n'+(null!=(n=t.invokePartial(i(a,"coverphoto-avatar"),o,{name:"coverphoto-avatar",data:r,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+(null!=(n=t.invokePartial(i(a,"coverphoto-title"),o,{name:"coverphoto-title",data:r,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+(null!=(n=t.invokePartial(i(a,"coverphoto-subtitle"),o,{name:"coverphoto-subtitle",data:r,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+(null!=(n=t.invokePartial(i(a,"coverphoto-stats"),o,{name:"coverphoto-stats",data:r,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+(null!=(n=t.invokePartial(i(a,"coverphoto-additional-meta"),o,{name:"coverphoto-additional-meta",data:r,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+"\n"+(null!=(n=t.invokePartial(i(a,"coverphoto-actions"),null!=o?i(o,"actionData"):o,{name:"coverphoto-actions",data:r,indent:"\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+"\t\t</div>\n\t</div>\n\n"+(null!=(n=t.invokePartial(i(a,"coverphoto-editor-controls"),o,{name:"coverphoto-editor-controls",data:r,indent:"\t",helpers:e,partials:a,decorators:t.decorators}))?n:"")+"\t\n"+(null!=(n=i(e,"if").call(l,null!=(n=null!=(n=null!=o?i(o,"coverPhoto"):o)?i(n,"attribution"):n)?i(n,"id"):n,{name:"if",hash:{},fn:t.program(3,r,0),inverse:t.noop,data:r,loc:{start:{line:95,column:1},end:{line:99,column:8}}}))?n:"")+"</div>"},usePartial:!0,useData:!0}),a={};t.Array.each(["coverphoto-avatar","coverphoto-title","coverphoto-actions","coverphoto-subtitle","coverphoto-stats","coverphoto-additional-meta","coverphoto-avatar","coverphoto-title","coverphoto-subtitle","coverphoto-stats","coverphoto-additional-meta","coverphoto-actions","coverphoto-editor-controls"],(function(o){var e=t.Template.get("hermes/"+o);e&&(a[o]=e)})),t.Template.register("hermes/fluid-coverphoto",(function(o,r){return(r=r||{}).partials=r.partials?t.merge(a,r.partials):a,e(o,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-coverphoto-avatar","hermes-template-coverphoto-title","hermes-template-coverphoto-actions","hermes-template-coverphoto-subtitle","hermes-template-coverphoto-stats","hermes-template-coverphoto-additional-meta","hermes-template-coverphoto-avatar","hermes-template-coverphoto-title","hermes-template-coverphoto-subtitle","hermes-template-coverphoto-stats","hermes-template-coverphoto-additional-meta","hermes-template-coverphoto-actions","hermes-template-coverphoto-editor-controls"]});YUI.add("hermes-template-fluid-avatar-editor",(function(t,a){var e=t.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(t,a,e,n,i){var l,s=t.lookupProperty||function(t,a){if(Object.prototype.hasOwnProperty.call(t,a))return t[a]};return'<div class="avatar-editor-container" style="height:'+t.escapeExpression("function"==typeof(l=null!=(l=s(e,"contentHeight")||(null!=a?s(a,"contentHeight"):a))?l:t.hooks.helperMissing)?l.call(null!=a?a:t.nullContext||{},{name:"contentHeight",hash:{},data:i,loc:{start:{line:1,column:51},end:{line:1,column:68}}}):l)+'px">\n\t<div class="avatar-clip">\n\t\t<div class="avatar-image"></div>\n\t</div>\n\n\t<div class="controls-area">\n\t\t<div class="zoom-controls">\n\t\t\t<p class="zoom-minus"></p>\n\t\t\t<p class="zoom-plus"></p>\n\n\t\t\t<div class="zoom-handle"></div>\n\n\t\t\t<div class="zoom-guide"><span class="low-quality-zone"></span></div>\n\t\t</div>\n\t</div>\n\n\t<div class="avatar-background">\n\t</div>\n</div>'},useData:!0}),n={};t.Array.each([],(function(a){var e=t.Template.get("hermes/"+a);e&&(n[a]=e)})),t.Template.register("hermes/fluid-avatar-editor",(function(a,i){return(i=i||{}).partials=i.partials?t.merge(n,i.partials):n,e(a,i)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-avatar-editor-view",(function(t){"use strict";var o={dragging:{mouseDownX:0,mouseDownY:0,previousX:0,previousY:0,centerX:0,centerY:0,startDrag:!1,overlayDiameter:0},zoom:{scale:1,scaleFactor:1,mouseDownX:0,previousX:0,startDrag:!1,midpoint:0,height:0,width:0,max:0,min:0,isLowQuality:!1},potential:{height:0,width:0,url:"",x:0,y:0},original:{x:0,y:0}},e=.25;t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.set("photoModel",t.photoModel),this.contentHeight=t.contentHeight,o.zoom.scale=1,o.dragging.startDrag=!1,o.zoom.startDrag=!1,this},loadState:function(){return t.Promise.resolve()},buildContainer:function(t){return this.setContainerWithTemplate("fluid-avatar-editor",{contentHeight:this.contentHeight}),this},activate:function(){return this.avatarBackground=this.get("container").one(".avatar-background"),this.avatarFocus=this.get("container").one(".avatar-image"),this.zoomHandle=this.get("container").one(".zoom-handle"),this.containerWidth=this.get("container").get("offsetWidth"),this.containerHeight=this.get("container").get("offsetHeight"),this.loadAvatarPhoto(),this},showTooltip:function(){this.zoomTooltip||(this.zoomTooltip=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!1,showDropArrow:!0,width:150,anchorElement:this.zoomHandle,textMessage:this.intlMessage({intlName:"header.MIN_ZOOM"}),invisibleOverlay:!0,classList:"over-modal",overlayClassList:"over-modal"})),this.zoomTooltip.show()},hideTooltip:function(){this.zoomTooltip&&!this.zoomTooltip.isClosed&&this.zoomTooltip.close()},loadAvatarPhoto:function(){var t,e=new Image;e.onload=this.handleImageLoad.bind(this),t=this.get("photoModel").getLargestSize(),o.potential.width=t.width,o.potential.height=t.height,o.potential.url=t.url,o.zoom.width=t.width*o.zoom.scale,o.zoom.height=t.height*o.zoom.scale,e.src=t.url,(e.complete||e.onloadFired)&&this.handleImageLoad()},handleImageLoad:function(){var t=this.get("container"),e=t.one(".avatar-clip");o.dragging.centerX=-1*(o.potential.width/2-this.containerWidth/2),o.dragging.centerY=-1*(o.potential.height/2-this.containerHeight/2),o.dragging.overlayDiameter=parseInt(e.getStyle("width"),10)/2,this.offsetLeft=this.containerWidth/2-o.dragging.overlayDiameter,this.offsetTop=this.containerHeight/2-o.dragging.overlayDiameter,o.potential.x=o.dragging.centerX,o.potential.y=o.dragging.centerY,o.original.x=o.dragging.centerX,o.original.y=o.dragging.centerY,this.saveParamsForAPI(),t.one(".avatar-image").setStyles({backgroundImage:"url("+o.potential.url+")",width:o.potential.width+"px",height:o.potential.height+"px",left:o.dragging.centerX+-1*this.offsetLeft+"px",top:o.dragging.centerY+-1*this.offsetTop+"px"}),t.one(".avatar-background").setStyles({backgroundImage:"url("+o.potential.url+")",width:o.potential.width+"px",height:o.potential.height+"px",left:o.dragging.centerX+"px",top:o.dragging.centerY+"px"}),this.setupEventListeners(),this.setupZoomHandler()},setupEventListeners:function(){var e=this.get("container"),i=e.one(".avatar-background"),a=e.one(".avatar-image"),n=e.one(".controls-area"),r=this;this.registerEventHandler(i.on(["mousedown","touchstart"],(function(t){t.halt(),o.dragging.mouseDownY=t.pageY||(t.touches&&t.touches.length?t.touches[0].pageY:0),o.dragging.mouseDownX=t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0),o.dragging.previousY=parseInt(i.getStyle("top"),10),o.dragging.previousX=parseInt(i.getStyle("left"),10),o.dragging.startDrag=!0,i.addClass("grabbing"),n.addClass("clickthrough")}))),this.registerEventHandler(i.on(["mousemove","touchmove"],(function(t){if(t.halt(),o.dragging.startDrag){var e=o.dragging.mouseDownY-(t.pageY||(t.touches&&t.touches.length?t.touches[0].pageY:0)),n=o.dragging.mouseDownX-(t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0)),s=o.dragging.previousY-e,g=o.dragging.previousX-n,h=r.snapFocusToFit(g,s);g=h.x,s=h.y,o.potential.x=g,o.potential.y=s,o.original.x=(r.containerWidth-r.containerWidth/o.zoom.scale)/2+o.potential.x/o.zoom.scale,o.original.y=(r.containerHeight-r.containerHeight/o.zoom.scale)/2+o.potential.y/o.zoom.scale,r.saveParamsForAPI(),i.setStyle("left",g),i.setStyle("top",s),a.setStyle("left",g+-1*r.offsetLeft),a.setStyle("top",s+-1*r.offsetTop)}}))),this.registerEventHandler(t.one("body").on(["mouseup","touchend"],(function(){o.dragging.startDrag=!1,i.removeClass("grabbing"),n.removeClass("clickthrough")}))),this.registerEventHandler(i.on(["mouseup","touchend"],(function(){o.dragging.startDrag=!1,i.removeClass("grabbing"),n.removeClass("clickthrough")})))},determineBoundaries:function(){return{minX:o.dragging.centerX+o.zoom.width/2-o.dragging.overlayDiameter,minY:o.dragging.centerY+o.zoom.height/2-o.dragging.overlayDiameter,maxX:o.dragging.centerX-o.zoom.width/2+o.dragging.overlayDiameter,maxY:o.dragging.centerY-o.zoom.height/2+o.dragging.overlayDiameter}},snapFocusToFit:function(t,o){var e=this.determineBoundaries();return{x:t=(t=t<=e.minX?t:e.minX)>=e.maxX?t:e.maxX,y:o=(o=o<=e.minY?o:e.minY)>=e.maxY?o:e.maxY}},setupZoomHandler:function(){var i,a=this,n=this.get("container"),r=n.one(".controls-area"),s=n.one(".zoom-controls"),g=n.one(".zoom-plus"),h=n.one(".zoom-minus");o.zoom.max=parseInt(s.get("offsetWidth"),10)-parseInt(this.zoomHandle.get("offsetWidth"),10),o.zoom.previousX=parseInt(this.zoomHandle.getStyle("left"),10),o.zoom.scaleFactor=1/(o.zoom.max/4),o.zoom.midpoint=o.zoom.max/2,i=Math.max(2*o.dragging.overlayDiameter/o.potential.width,2*o.dragging.overlayDiameter/o.potential.height),o.zoom.min=2*(i-e)/o.zoom.scaleFactor,o.zoom.min>o.zoom.max&&(o.zoom.isLowQuality=!0,this.zoomHandle.setStyle("left",o.zoom.max)),n.one(".low-quality-zone").setStyle("width",Math.min(o.zoom.min,o.zoom.max)),o.zoom.scale=Math.max(o.zoom.min,o.zoom.midpoint)*o.zoom.scaleFactor/2+e,this.updateImageScale(),this.registerEventHandler(this.zoomHandle.on(["mousedown","touchstart"],this.onZoomBarClicked.bind(this))),this.registerEventHandler(r.on(["mousemove","touchmove"],this.onZoomBarMoved.bind(this))),this.registerEventHandler(g.on("click",this.zoomByIncrement.bind(this))),this.registerEventHandler(h.on("click",this.zoomByIncrement.bind(this))),this.registerEventHandler(n.on(["mouseup","touchend"],(function(t){t.halt(),o.zoom.startDrag=!1,a.zoomHandle.removeClass("dragging")}))),this.registerEventHandler(t.one("body").on(["mouseup","touchend"],(function(t){o.zoom.startDrag=!1,a.zoomHandle.removeClass("dragging")})))},onZoomBarClicked:function(t){t.halt(),o.zoom.mouseDownX=t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0),o.zoom.startDrag=!0,o.zoom.previousX=parseInt(this.zoomHandle.getStyle("left"),10),this.zoomHandle.addClass("dragging")},onZoomBarMoved:function(t){if(t.halt(),o.zoom.startDrag){var i=o.zoom.mouseDownX-(t.pageX||(t.touches&&t.touches.length?t.touches[0].pageX:0)),a=o.zoom.previousX-i;a=(a=a<=o.zoom.min?o.zoom.min:a)>=o.zoom.max?o.zoom.max:a,o.zoom.scale=a*o.zoom.scaleFactor/2+e,a<=o.zoom.min&&o.zoom.isLowQuality?this.showTooltip():(a===o.zoom.min?this.showTooltip():this.hideTooltip(),this.zoomHandle.setStyle("left",a),this.updateImageScale())}},zoomByIncrement:function(t){var i,a=parseInt(this.zoomHandle.getStyle("left"));t&&(t.halt(),t.target.hasClass("zoom-plus")?i=a+parseInt(o.zoom.max/10):t.target.hasClass("zoom-minus")&&(i=a-parseInt(o.zoom.max/10)),(i=(i=i<=o.zoom.min?o.zoom.min:i)>=o.zoom.max?o.zoom.max:i)<=o.zoom.min&&o.zoom.isLowQuality?this.showTooltip():(i===o.zoom.min?this.showTooltip():this.hideTooltip(),o.zoom.previousX=i,o.zoom.scale=i*o.zoom.scaleFactor/2+e,this.zoomHandle.setStyle("left",i),this.updateImageScale()))},updateImageScale:function(){var t,e,i;o.zoom.width=o.potential.width*o.zoom.scale,o.zoom.height=o.potential.height*o.zoom.scale,o.dragging.centerX=-1*(o.zoom.width/2-this.containerWidth/2),o.dragging.centerY=-1*(o.zoom.height/2-this.containerHeight/2),t=(this.containerWidth-this.containerWidth*o.zoom.scale)/2+o.original.x*o.zoom.scale,e=(this.containerHeight-this.containerHeight*o.zoom.scale)/2+o.original.y*o.zoom.scale,t=(i=this.snapFocusToFit(t,e)).x,e=i.y,o.potential.x=t,o.potential.y=e,this.saveParamsForAPI(),this.avatarBackground.setStyles({width:o.zoom.width+"px",height:o.zoom.height+"px",left:t+"px",top:e+"px"}),this.avatarFocus.setStyles({width:o.zoom.width+"px",height:o.zoom.height+"px",left:t+-1*this.offsetLeft+"px",top:e+-1*this.offsetTop+"px"})},saveParamsForAPI:function(){var e=o.zoom.width/2-(o.potential.x-o.dragging.centerX),i=o.zoom.height/2-(o.potential.y-o.dragging.centerY);e/=o.zoom.scale,i/=o.zoom.scale,this.set("apiParams",{x1:parseInt(e-o.dragging.overlayDiameter/o.zoom.scale),x2:parseInt(e+o.dragging.overlayDiameter/o.zoom.scale),y1:parseInt(i-o.dragging.overlayDiameter/o.zoom.scale),y2:parseInt(i+o.dragging.overlayDiameter/o.zoom.scale),url:t.URLHelper.addProtocolToURL(o.potential.url)})},destructor:function(){return this.hideTooltip(),this.constructor.superclass.destroy.call(this)}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-avatar-editor","url-helper","fluid-droparound-view"],langBundles:["header"]});