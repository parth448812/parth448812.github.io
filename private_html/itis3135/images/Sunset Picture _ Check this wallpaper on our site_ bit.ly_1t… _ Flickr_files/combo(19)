YUI.add("flickr-account-getPrivileges-fetcher",(function(e,i){"use strict";e.namespace("ModelFetchers")["flickr-account-getPrivileges"]={run:function(r,s){var t=this;return e.FlickrPromise({apiResponse:s.callAPI("flickr.account.getPrivileges",r),privilegesRegistry:s.getModelRegistry("privileges-models")}).then((function(e){return t._processResponse(e,s,r)}),e.FetcherErrorLogger(i))},_processResponse:function(e,i,r){var s=e.apiResponse,t=e.privilegesRegistry,o={id:r.id,privileges:s.privileges,uploadLimits:s.uploadLimits};return t.add(o),t.proxy(r.id)}}}),"@VERSION@",{requires:["flickr-promise"],optional:["privileges-models","api-helper"]});YUI.add("privileges-models",(function(e){function i(e){i.superclass.constructor.call(this,e)}e.Models[this.name]=i,e.extend(i,e.FlickrModelRegistry,{name:this.name,remote:{read:function(i){return e.ModelFetchers["flickr-account-getPrivileges"].run(i,this.appContext)}},attributes:{id:{},privileges:{},uploadLimits:{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-account-getPrivileges-fetcher"]});YUI.add("person-model-helper",(function(e){e.PersonModelHelper={attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},nsid:{readOnly:!0,defaultFn:function(e){return e}},url:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/photos/"+this.getValue(e,"pathAlias")+"/"}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}}}}}),"@VERSION@",{requires:[]});YUI.add("person-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,url:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,buddyicon:{},isPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proBadge:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isMinor:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proExpireDate:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},isDeleted:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isAdFree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isNoAds:{derivedBy:["isPro","isAdFree"],readOnly:!0,getter:function(e,t){var r=this.getValue(t,"isPro"),n=this.getValue(t,"isAdFree");return r||n}},hasStats:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasAdfree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has1TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has2TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasUnlimitedStorage:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeStandardShipping:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeEducationalResources:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},location:{defaultFn:function(){return""}},expiringPartner:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}},uploadCount:{defaultValue:null},uploadLimit:{defaultValue:null},uploadLimitStatus:{defaultValue:null},isCognitoUser:{defaultValue:null},hasAuthorizedMobile:{defaultValue:null},hasInvalidEmail:{defaultValue:!1},subscription:{defaultValue:{isPastDue:!1,isPro:!1,isClosed:!1}},contactsCacheUrl:{defaultValue:!1},segments:{defaultValue:[]},isEligibleForGifts:{defaultValue:!1},eligibleGifts:{defaultValue:[]},newFlow:{defaultValue:!1}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","attribute-helpers","person-model-helper","moment"]});YUI.add("flickr-people-getInfo-fetcher",(function(e,s){"use strict";var r=new e.SubscriptionsHelper,o=require("hermes-core/flog")(s);e.namespace("ModelFetchers")["flickr-people-getInfo"]={run:function(r,o){var i=this,t=o.getViewer();return t&&t.signedIn&&(r.id===t.nsid||r.nsid===t.nsid)&&(r.storage=1),new e.FlickrPromise({apiResponse:o.callAPI("flickr.people.getInfo",this._processParams(r,o),!0),personModelRegistry:o.getModelRegistry("person-models"),personRelationshipModelRegistry:o.getModelRegistry("person-relationship-models"),personProfileModelRegistry:o.getModelRegistry("person-profile-models"),personPreferencesModelRegistry:o.getModelRegistry("person-preferences-models"),personGroupsModelRegistry:o.getModelRegistry("person-groups-models"),personNotificationsModelRegistry:o.getModelRegistry("person-notifications-models"),photostreamModelRegistry:o.getModelRegistry("photostream-models"),privilegesModelRegistry:o.getModelRegistry("privileges-models")}).then((function(e){return i._processResponse(e,r,o)}),e.FetcherErrorLogger(s))},_processParams:function(s,r){var o={datecreate:1,extras:e.APIHelper.request.getRebootPeopleExtras()};if(YUI.Env.isServer&&s.id===r.request.probableUser?(o.storage=1,o.extras+=","+["classic_user_id","timezone_dst","unified_search_view_pref","photostream_view_order_pref","photostream_view_as_pref","album_view_layout","download_pref","products_features","subscriptions","is_minor","privileges"].join(",")):r.getViewer().signedIn&&s.id===r.getViewer().nsid&&(o.extras+=","+["products_features","subscriptions"].join(",")),s.extras&&"string"==typeof s.extras&&s.extras.length>0&&(o.extras+=","+s.extras),s.id)o.user_id=s.id;else{if(!s.pathAlias)throw new Error("`fetch` is missing required params.");o.path_alias=s.pathAlias}return s.storage&&(o.storage=s.storage),o.extras||(o.extras=""),o.extras+=", has_stats",o},_processResponse:function(s,i,t){var a,n,l,p=s.apiResponse,d=s.personModelRegistry,g=s.personRelationshipModelRegistry,c=s.personProfileModelRegistry,u=s.personPreferencesModelRegistry,m=s.personGroupsModelRegistry,h=s.personNotificationsModelRegistry,f=s.photostreamModelRegistry,v=s.privilegesModelRegistry,M=p.person,_=t.getViewer(),y=M.id,R=_&&_.signedIn&&y===_.nsid;return l={id:y,pathAlias:M.pathAlias,username:M.username&&M.username._content,realname:M.realname&&M.realname._content,buddyicon:e.APIHelper.response.removeProtocolFromURL(M.iconurls),isAdFree:M.isAdFree,isPro:M.ispro,proBadge:M.proBadge,isMinor:M.isMinor,hasStats:M.hasStats,location:M.location&&M.location._content,hasAdfree:M.hasAdfree,has1TB:M.has1TB,has2TB:M.has2TB,hasUnlimitedStorage:M.hasUnlimitedStorage,hasFreeStandardShipping:M.hasFreeStandardShipping,hasFreeEducationalResources:M.hasFreeEducationalResources,dateCreated:M.datecreate._content,expiringPartner:M.expiringPartner},M.ispro&&(l.proExpireDate=M.expire),M.gift&&(l.isEligibleForGifts=M.gift.giftEligible||!1,l.eligibleGifts=M.gift.eligibleDurations||[],l.newFlow=M.gift.newFlow||!1),R&&(l.uploadLimit=M.uploadLimit,l.uploadCount=M.uploadCount,l.uploadLimitStatus=M.uploadLimitStatus,l.isCognitoUser=M.isCognitoUser,l.hasInvalidEmail=!1,M.email&&(!M.email||M.email._content&&""!==M.email._content)?M.email._content&&-1===M.email._content.indexOf("@")?l.hasInvalidEmail=!0:l.hasInvalidEmail=!1:l.hasInvalidEmail=!0,l.isPro&&(l.subscription=r.parseEffectiveSubscriptionData(!0,p.effectiveSubscriptions)),M.contactsCacheUrl&&(l.contactsCacheUrl=M.contactsCacheUrl),M.segments&&M.segments.length?(l.segments=M.segments,o.info("User belongs to these segments",l.segments)):o.info("User is not in any segment")),d.addOrUpdate(l),h.addOrUpdate({id:y,unreadFlickrMailCount:M.unreadMessages?M.unreadMessages.content:0}),g.addOrUpdate({id:y,pathAlias:M.pathAlias,isContact:M.contact,isFriend:M.friend,isFamily:M.family,isIgnored:M.ignored,isIgnoredBy:M.ignoredby,isRevContact:M.revcontact,isRevFriend:M.revfriend,isRevFamily:M.revfamily}),R&&(n={id:y},M.safeSearch&&(n.safeSearch=(M.safeSearch||1)-1),M.viewPrefs&&(n.unifiedSearchViewPref=M.viewPrefs.unifiedSearchViewPref,n.photostreamViewOrderPref=M.viewPrefs.photostreamViewOrderPref,n.photostreamViewAsPref=M.viewPrefs.photostreamViewAsPref,n.albumViewLayoutPref=M.viewPrefs.albumViewLayout,n.galleryViewLayoutPref=M.viewPrefs.galleriesViewLayoutPref),u.exists(y)?u.setValues(y,n):u.add(n)),a={id:y,coverPhotoUrls:e.APIHelper.response.removeProtocolFromURL(M.coverphoto_url),photoCount:M.photos.count.content,location:M.location?M.location.content:null,arrPhotoCount:M.all_rights_reserved_photos_count},M.storage&&(a.storageUsed=M.storage.used.content,a.storageTotal=M.storage.total.content),M.unreadMessages&&(a.unreadMessages=M.unreadMessages.content),c.addOrUpdate(a),m.addOrUpdate({id:y,memberCount:M.groupMemberships?M.groupMemberships.member:null,moderatorCount:M.groupMemberships?M.groupMemberships.moderator:null,adminCount:M.groupMemberships?M.groupMemberships.admin:null,invitedCount:M.groupMemberships?M.groupMemberships.invited:null}),f.addOrUpdate({id:y,pathAlias:M.pathAlias,owner:d.proxy(y),totalItems:M.photos.count&&M.photos.count.content}),t.flipper.isFlipped("enable_new_free_limits")&&v.addOrUpdate({id:y,privileges:M.privileges,uploadLimits:M.uploadLimits}),M}}}),"@VERSION@",{requires:["flickr-promise","subscriptions-helper"],optionalRequires:["hermes-core"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-groups-models","photostream-models","person-notifications-models","privileges-models","api-helper"]});YUI.add("person-relationship-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[],n={};return e.Lang.isObject(i,!0)&&(n.user_id=t,n.friend=this.getValue(t,"isFriend"),n.family=this.getValue(t,"isFamily"),"isContact"in i&&(i.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(n,this.appContext))),("isFriend"in i||"isFamily"in i)&&("isFriend"in i&&(n.friend=i.isFriend.newVal),"isFamily"in i&&(n.family=i.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(n,this.appContext))),"isIgnored"in i&&(!0===i.isIgnored.newVal?r.push(e.ModelUpdaters["flickr-contacts-block"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(n,this.appContext)))),e.Promise.all(r)}},toggleFollowing:function(e){this.getValue(e,"isContact")?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){this.getValue(e,"isFriend")?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){this.getValue(e,"isFamily")?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){this.getValue(e,"isIgnored")?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var i=this.appContext.getViewer();return!!i&&this.getValue(t,"nsid")===i.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});YUI.add("math-helper",(function(e){e.MathHelper=function(e){return{seedRandom:function(e){return 0+1*((e=(9301*e+49297)%233280)/233280)}}}}),"@VERSION@",{requires:[]});YUI.add("banner-helper",(function(e,i){var n=require("hermes-core/flog")(i),r=(e.mix({langBundles:["featured-banner"]},e.Localizable),new e.SubscriptionsHelper);e.BannerHelper=function(i){var o=this,t=[],s=[],a={loginMigration:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){var e=!1,n=i.getViewer().isCognitoUser;return i.getViewer().signedIn&&!n&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","download-page-view"].indexOf(i.flapp.get("activeView").name)&&(e=!0),e},viewName:"login-migration-banner-view",viewConfig:{}}},pastDue:function(n){var r;function o(){return-1===["pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","account-settings-view"].indexOf(i.flapp.get("activeView").name)}return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("person-models",n.nsid).then((function(e){var i=e.getValue("subscription");r=i.isPastDue})):(r=!1,e.Promise.resolve())},canShowBanner:function(){var e=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&o()&&r&&(e=!0),e&&o()},viewName:"past-due-banner-view",viewConfig:{}}},migrateSubscription:function(n){var o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"header",s=!1,a=!1;return{priority:o,placement:t,load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("effective-subscriptions-models",n.nsid).then(function(n){if(n&&n.getValue("length")>0){var o=r.getEligibleSubscription(n,!0);o&&(s=o.isBraintreeSubscription||o.isDigitalRiverSubscription&&i.flipper.isFlipped("enable-dr-paypal-migrate-banner"),a=o.nextBillingDate&&o.nextBillingDate.isBefore&&o.nextBillingDate.isBefore(e.moment().add(15,"days")))}}.bind(this)):(s=!1,e.Promise.resolve())},canShowBanner:function(){var n=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&s&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","download-page-view"].indexOf(i.flapp.get("activeView").name)&&(!i.getCookie(e.config.flickr.banners.dismiss_braintree_migration_banner_name)||i.getCookie(e.config.flickr.banners.dismiss_braintree_migration_banner_name)&&a)&&(n=!0),n},viewName:"subscription-migrate-banner-view",viewConfig:{}}},cookie:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"footer",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_cookie_banner_name)&&!i.requiresCookieConsent},viewName:"cookie-banner-view",viewConfig:{}}},cookieConsent:function(n){var r,o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"footer";return{priority:o,placement:t,load:function(){return i.trustarcConsentManager?new e.Promise(((e,n)=>{r=setTimeout(e,1e4),i.trustarcConsentManager.onReady((()=>{clearTimeout(r),e()}))})):e.Promise.resolve()},canShowBanner:function(){var e=i.flipper.isFlipped("enable-cookie-consent-execution-hermes")&&i.requiresCookieConsent&&"truste"in window&&"PrivacyManagerAPI"in window;if(e){var n=window.truste.cma.callApi("getConsentDecision","flickr.com");n&&(e=0===n.consentDecision)}return e},viewName:"trustarc-consent-banner-view",viewConfig:{}}},uploadLimit:function(n){var r;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return i.getViewer().signedIn?i.getModel("person-profile-models",i.getViewer().nsid).then((function(e){r=e})):e.Promise.resolve()},canShowBanner:function(){var n=!i.getCookie(e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isOverARRLimit(r,i)&&"products-flickrpro-route"!==i.routeConfig.module,o=!i.getCookie(e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isAtUploadLimit(r,i),t=!i.getCookie(e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isNearUploadLimit(r,i);return i.flipper.isFlipped("enable-upload-limit-messages")&&i.getViewer().signedIn&&"pro-checkout-route"!==i.routeConfig.module&&(n||o||t)},viewName:"upload-limit-banner-view",viewConfig:{}}},ybsExplore:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_ybs_explore_banner_name)&&"explore-page-view"===i.flapp.get("activeView").name},viewName:"ybs-explore-banner-view",viewConfig:{},startTime:new Date("2023-01-26T05:00:00.000Z"),endTime:new Date("2023-01-27T04:55:00.000Z")}},surveyModal:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header";let t,s=new e.MathHelper;return{priority:r,placement:o,load:function(){let e=i.getViewer();return e.signedIn?i.getModel("person-models",e.nsid).then((function(e){t=e})):Promise.resolve()},canShowBanner:function(){let n=!1,r=t?t.getValue("nsid"):void 0,o=new URLSearchParams(window.location.search);if(!r)return!1;if(i.flipper.isFlipped("enable-feedback-modal")){var a=!0,l=parseInt(r.substring(0,r.indexOf("@")));l&&(a=i.viewportData.getWidth()>700?s.seedRandom(l)<.05:s.seedRandom(l)<.3),!YUI.Env.isServer&&"en-US"===i.lang&&a&&i.getViewer().signedIn&&"photostream-route"!==i.routeConfig.module&&!window.localStorage.getItem(e.config.flickr.banners.dismiss_survey_modal_name)&&window.URLSearchParams&&(n=!0)}return!i.flipper.isFlipped("enable-force-feedback-modal")||YUI.Env.isServer||window.localStorage.getItem(e.config.flickr.banners.dismiss_survey_modal_name)||(n=!0),i.flipper.isFlipped("enable-feedback-modal")&&o.has("survey")&&(n=!0),n},viewName:"feedback-prompt-view",viewConfig:{}}},eoy22:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=new Date("2022-12-26T18:00:00.000Z"),s=new Date("2023-01-04T07:59:59.000Z"),a=!0;return{priority:r,placement:o,load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("effective-subscriptions-models",n.nsid).then((e=>{(0===e.getValue("closed").length||e.getValue("pending").length>0)&&(a=!1)})):e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_eoy_banner_name)&&a&&i.getViewer().signedIn},viewName:"eoy-banner-view",viewConfig:{},startTime:t,endTime:s}},printShop:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_print_shop_banner_name)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","download-page-view"].indexOf(i.flapp.get("activeView").name)&&"prints-discovery-page-view"!==i.flapp.get("activeView").name},viewName:"print-shop-banner-view",viewConfig:{},startTime:new Date("2023-01-23T18:00:00.000Z"),endTime:new Date("2023-02-24T07:59:59.000Z")}},exploredUpsell:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=i.getViewer(),s=!1;return{priority:r,placement:o,load:function(){return t.isPro||i.segments.hasSegment("explored_non_pro_users")&&(s=!0),e.Promise.resolve()},canShowBanner:function(){return!t.isPro&&s&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","download-page-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_explored_upsell_banner_name)&&i.flipper.isFlipped("enable-explored-upsell-banner")},viewName:"explored-upsell-banner-view",viewConfig:{}}},churnedProBanner:function(n){var r="priority"in n?n.priority:Number.MAX_VALUE,o="placement"in n?n.placement:"header",t=i.getViewer(),s=!1;return{priority:r,placement:o,load:function(){return t.isPro||i.segments.hasSegment("pro_churned_user_1_month")&&(s=!0),e.Promise.resolve()},canShowBanner:function(){return s&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","download-page-view"].indexOf(i.flapp.get("activeView").name)&&!i.getCookie(e.config.flickr.banners.dismiss_churned_pro_banner_name)&&i.flipper.isFlipped("enable-churned-upsell-banner")},viewName:"churned-pro-banner-view",viewConfig:{}}}};function l(){s=t.sort((function(e,i){return e.priority-i.priority}))}function p(e){var i,n,r=s.find((function(i,n){var r=void 0===e||i.placement===e,o=new Date,t=o<i.startTime||o>i.endTime;if(r&&!t&&i.canShowBanner())return!0}));if(r)return i=t.indexOf(r),-1!==(n=i)&&(t.splice(n,1),l()),r}return this.loadBanners=function(i){var r;return t=[],s=[],r=i.map((function(i){return(function(i){var r=new a[i.type]({priority:i.priority,placement:i.placement});return r?r.load().then((function(){!(function(e){t.push(e),l()})(r)})).catch((function(e){n.error("Failed to load and register banner.",{err:e})})):e.Promise.resolve()})(i)})),e.Promise.all(r)},this.getBanners=function(e){var i=[];return e.forEach((function(e){var n=p(e);n&&i.push(n)})),i},this.getQueue=function(){return s},this.typeObjects=a,this.renderBannerView=function(e){return(function(e){return i.getView(e.viewName,e.viewConfig).then((function(e){var n;return i.getView("banner-view",{subview:e}).then((function(e){return(n=e).initialize()})).then((function(){return n}))}),(function(e){n.warn("Error loading banner view",{err:e})}))})(e).then((function(i){o.fire("renderBanner",{placement:e.placement,bannerView:i})}))},this},e.augment(e.BannerHelper,e.EventTarget)}),"@VERSION@",{requires:["banner-view","event-custom","effective-subscriptions-models","person-models","subscriptions-helper","math-helper","moment"],optionalRequires:["hermes-core"]});YUI.add("storage-helper",(function(e){e.StorageHelper={setItem:function(t,i,n){var o=n?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[o][t]=i}catch(e){}},getItem:function(t,i){var n,o=i?"sessionStorage":"localStorage";if(e.config.win)try{n=e.config.win[o][t]}catch(e){}return n},remove:function(t,i){var n=i?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[n].removeItem(t)}catch(e){}},hasEntries:function(t,i){var n=i?"sessionStorage":"localStorage",o=!1;if(e.config.win)try{o=void 0!==e.config.win[n][t]}catch(e){}return o},isLocalStorageAvailable:function(){var t="checkLSCompat",i=!1;try{e.config.win.localStorage[t]="checkLSCompatValue",e.config.win.localStorage.removeItem(t),i=!0}catch(e){i=!1}return i}},e.Storage={Instance:{_cache:{},_hasSessionStorage:!0,_clientIdKey:"",getClientIdKey:function(){return this._clientIdKey||(this._clientIdKey=e.config.win.appContext.clientId+"_"),this._clientIdKey},get:function(t){var i,n;try{t=t||"",i=this.getClientIdKey()+t,n=this._hasSessionStorage?e.config.win.sessionStorage.getItem(i):this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},set:function(t,i){var n;try{t&&(n=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.setItem(n,i):this._cache[n]=i)}catch(e){this._cache[n]=i,this._hasSessionStorage=!1}},has:function(t){var i,n=!1;try{i=this.getClientIdKey()+t,n=this._hasSessionStorage?!!e.config.win.sessionStorage.getItem(i):!!this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},remove:function(t){var i;try{t=t||"",i=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.removeItem(i):this._cache[i]=void 0}catch(e){this._hasSessionStorage=!1}},clear:function(){this.clearByKey(this.getClientIdKey())},clearByKey:function(t){var i,n,o,s=[];try{if(t)if(this._hasSessionStorage){for(i=0,o=e.config.win.sessionStorage.length;i<o;i++)(n=e.config.win.sessionStorage.key(i))&&0===n.indexOf(t)&&s.push(n);for(i=0,o=s.length;i<o;i++)e.config.win.sessionStorage.removeItem(s[i])}else for(e.Object.each(this._cache,(function(e,i){0===i.indexOf(t)&&s.push(i)})),i=0,o=s.length;i<o;i++)this._cache[s[i]]=void 0}catch(e){this._hasSessionStorage=!1}}}}}),"@VERSION@",{requires:[]});